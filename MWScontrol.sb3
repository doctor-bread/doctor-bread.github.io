{"targets":[{"isStage":true,"name":"Stage","variables":{},"lists":{},"broadcasts":{},"blocks":{},"comments":{},"currentCostume":0,"costumes":[{"name":"backdrop1","dataFormat":"svg","assetId":"cd21514d0531fdffb22204e0ec5ed84a","md5ext":"cd21514d0531fdffb22204e0ec5ed84a.svg","rotationCenterX":240,"rotationCenterY":180}],"sounds":[],"volume":100,"layerOrder":0,"tempo":60,"videoTransparency":50,"videoState":"on","textToSpeechLanguage":null},{"isStage":false,"name":"mws","variables":{"y{_])z7|!:01t#z~s#hC":["datetime","2024-09-05 15:56:00"]},"lists":{},"broadcasts":{},"blocks":{"o":{"opcode":"serverData_loadFromServer","next":null,"parent":"a","inputs":{"variableName":[1,[10,"breadMWSTime.txt"]]},"fields":{},"shadow":false,"topLevel":false},"f":{"opcode":"sipctime_TimestampToTime","next":null,"parent":"g","inputs":{"timestamp":[3,"h",[4,"1725522981000"]]},"fields":{},"shadow":false,"topLevel":false},"h":{"opcode":"operator_join","next":null,"parent":"f","inputs":{"STRING1":[3,"a",[10,"apple "]],"STRING2":[1,[10,"000"]]},"fields":{},"shadow":false,"topLevel":false},"a":{"opcode":"strings_replace","next":null,"parent":"h","inputs":{"SUBSTRING":[3,"p",[10,"world"]],"STRING":[3,"o",[10,"Hello world!"]],"REPLACE":[1,[10,""]]},"fields":{},"shadow":false,"topLevel":false},"p":{"opcode":"utilities_newline","next":null,"parent":"a","inputs":{},"fields":{},"shadow":false,"topLevel":false},"i":{"opcode":"procedures_definition","next":"g","parent":null,"inputs":{"custom_block":[1,"q"]},"fields":{},"shadow":false,"topLevel":true,"x":1069,"y":64},"q":{"opcode":"procedures_prototype","next":null,"parent":"i","inputs":{},"fields":{},"shadow":true,"topLevel":false,"mutation":{"tagName":"mutation","children":[],"proccode":"rulebreak timestamp","argumentids":"[]","argumentnames":"[]","argumentdefaults":"[]","warp":"false"}},"g":{"opcode":"procedures_return","next":null,"parent":"i","inputs":{"VALUE":[3,"f",[10,""]]},"fields":{},"shadow":false,"topLevel":false},"r":{"opcode":"procedures_call","next":null,"parent":"s","inputs":{},"fields":{},"shadow":false,"topLevel":false,"mutation":{"tagName":"mutation","children":[],"proccode":"rulebreak timestamp","argumentids":"[]","warp":"false","return":"1"}},"j":{"opcode":"procedures_definition","next":"b","parent":null,"inputs":{"custom_block":[1,"c"]},"fields":{},"shadow":false,"topLevel":true,"x":1069,"y":272},"c":{"opcode":"procedures_prototype","next":null,"parent":"j","inputs":{"c1a2bca6ea8a80b50cf4":[1,"t"],",Sf{JL2LzF3^_iXrj@@Q":[1,"u"]},"fields":{},"shadow":true,"topLevel":false,"mutation":{"tagName":"mutation","children":[],"proccode":"set time to %s %s","argumentids":"[\"c1a2bca6ea8a80b50cf4\",\",Sf{JL2LzF3^_iXrj@@Q\"]","argumentnames":"[\"A\",\"B\"]","argumentdefaults":"[\"\",\"\"]","warp":"false"}},"t":{"opcode":"argument_reporter_string_number","next":null,"parent":"c","inputs":{},"fields":{"VALUE":["A"]},"shadow":true,"topLevel":false},"v":{"opcode":"procedures_call","next":null,"parent":null,"inputs":{"c1a2bca6ea8a80b50cf4":[1,"w"],",Sf{JL2LzF3^_iXrj@@Q":[1,[10,"15:56:00"]]},"fields":{},"shadow":false,"topLevel":true,"x":48,"y":192,"mutation":{"tagName":"mutation","children":[],"proccode":"set time to %s %s","argumentids":"[\"c1a2bca6ea8a80b50cf4\",\",Sf{JL2LzF3^_iXrj@@Q\"]","warp":"false"}},"w":{"opcode":"0znzwMoreFields_DateInline","next":null,"parent":"v","inputs":{},"fields":{"field_0znzwMoreFields_DateInline":["2024-09-05"]},"shadow":true,"topLevel":false},"s":{"opcode":"lmscomments_commentCommand","next":null,"parent":null,"inputs":{"COMMENT":[3,"r",[10,"comment"]]},"fields":{},"shadow":false,"topLevel":true,"x":48,"y":64},"b":{"opcode":"data_setvariableto","next":"k","parent":"j","inputs":{"VALUE":[3,"d",[10,"0"]]},"fields":{"VARIABLE":["datetime","y{_])z7|!:01t#z~s#hC"]},"shadow":false,"topLevel":false},"x":{"opcode":"argument_reporter_string_number","next":null,"parent":"d","inputs":{},"fields":{"VALUE":["A",null]},"shadow":false,"topLevel":false},"u":{"opcode":"argument_reporter_string_number","next":null,"parent":"c","inputs":{},"fields":{"VALUE":["B",null]},"shadow":true,"topLevel":false},"d":{"opcode":"operator_join","next":null,"parent":"b","inputs":{"STRING1":[3,"x",[10,"apple "]],"STRING2":[3,"l",[10,"banana"]]},"fields":{},"shadow":false,"topLevel":false},"y":{"opcode":"argument_reporter_string_number","next":null,"parent":"l","inputs":{},"fields":{"VALUE":["B",null]},"shadow":false,"topLevel":false},"l":{"opcode":"operator_join","next":null,"parent":"d","inputs":{"STRING1":[1,[10," "]],"STRING2":[3,"y",[10,""]]},"fields":{},"shadow":false,"topLevel":false},"k":{"opcode":"serverData_saveToServer","next":null,"parent":"b","inputs":{"variableName":[1,[10,"breadMWSTime.txt"]],"content":[3,"e",[10,""]]},"fields":{},"shadow":false,"topLevel":false},"z":{"opcode":"sipctime_TimeToTimestamp","next":null,"parent":"e","inputs":{"time":[3,[12,"datetime","y{_])z7|!:01t#z~s#hC"],[10,"2020-06-08 17:59:23"]]},"fields":{},"shadow":false,"topLevel":false},"e":{"opcode":"strings_letters_of","next":null,"parent":"k","inputs":{"LETTER1":[1,[4,"1"]],"LETTER2":[3,"m",[4,"4"]],"STRING":[3,"z",[10,"apple"]]},"fields":{},"shadow":false,"topLevel":false},"A":{"opcode":"sipctime_TimeToTimestamp","next":null,"parent":"n","inputs":{"time":[3,[12,"datetime","y{_])z7|!:01t#z~s#hC"],[10,"2020-06-08 17:59:23"]]},"fields":{},"shadow":false,"topLevel":false},"n":{"opcode":"operator_length","next":null,"parent":"m","inputs":{"STRING":[3,"A",[10,"apple"]]},"fields":{},"shadow":false,"topLevel":false},"m":{"opcode":"operator_subtract","next":null,"parent":"e","inputs":{"NUM1":[3,"n",[4,""]],"NUM2":[1,[4,"3"]]},"fields":{},"shadow":false,"topLevel":false},"B":{"opcode":"procedures_call","next":null,"parent":null,"inputs":{"c1a2bca6ea8a80b50cf4":[1,[10,"2024-09-05"]],",Sf{JL2LzF3^_iXrj@@Q":[1,[10,"15:56:00"]]},"fields":{},"shadow":false,"topLevel":true,"x":48,"y":320,"mutation":{"tagName":"mutation","children":[],"proccode":"set time to %s %s","argumentids":"[\"c1a2bca6ea8a80b50cf4\",\",Sf{JL2LzF3^_iXrj@@Q\"]","warp":"false"}}},"comments":{},"currentCostume":0,"costumes":[{"name":"costume1","bitmapResolution":1,"dataFormat":"svg","assetId":"927d672925e7b99f7813735c484c6922","md5ext":"927d672925e7b99f7813735c484c6922.svg","rotationCenterX":30.74937882782359,"rotationCenterY":58.864768144346826}],"sounds":[],"volume":100,"layerOrder":1,"visible":true,"x":0,"y":0,"size":100,"direction":90,"draggable":false,"rotationStyle":"all around"}],"monitors":[],"extensions":["serverData","sipctime","strings","utilities","0znzwMoreFields","lmscomments"],"extensionURLs":{"serverData":"data:text/javascript;base64,Ly8gU2ltcGxlIGZpbGUgc3RvcmFnZSBtYWRlIHdpdGggdG9vbHMgZnJvbSBTbmFwIQ0KDQpjbGFzcyBTZXJ2ZXJFeHRlbnNpb24gew0KICBjb25zdHJ1Y3RvcihydW50aW1lKSB7DQogICAgdGhpcy5ydW50aW1lID0gcnVudGltZTsNCiAgICB0aGlzLnNlcnZlclVSTCA9ICdodHRwczovL3NuYXBleHRlbnNpb25zLnVuaS1nb2V0dGluZ2VuLmRlL2hhbmRsZVRleHRmaWxlLnBocCc7DQogIH0NCg0KICBnZXRJbmZvKCkgew0KICAgIHJldHVybiB7DQogICAgICBpZDogJ3NlcnZlckRhdGEnLA0KICAgICAgbmFtZTogJ1NRTFNuYXAhIFNlcnZlcnMnLA0KICAgICAgY29sb3IxOiAnIzMxYjNkNCcsDQogICAgICBjb2xvcjI6ICcjMTc5ZmMyJywNCiAgICAgIGJsb2NrczogWw0KICAgICAgICB7DQogICAgICAgICAgb3Bjb2RlOiAnc2F2ZVRvU2VydmVyJywNCiAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsDQogICAgICAgICAgdGV4dDogJ3NhdmUgW3ZhcmlhYmxlTmFtZV0gd2l0aCBjb250ZW50IFtjb250ZW50XScsDQogICAgICAgICAgYXJndW1lbnRzOiB7DQogICAgICAgICAgICB2YXJpYWJsZU5hbWU6IHsNCiAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdkZWZhdWx0LnR4dCcsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgY29udGVudDogew0KICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ0hlbGxvLCBXb3JsZCEnLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICB9LA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgb3Bjb2RlOiAnbG9hZEZyb21TZXJ2ZXInLA0KICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsDQogICAgICAgICAgdGV4dDogJ2xvYWQgW3ZhcmlhYmxlTmFtZV0nLA0KICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgdmFyaWFibGVOYW1lOiB7DQogICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnZGF0YS50eHQnLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICB9LA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgb3Bjb2RlOiAnZml0cycsDQogICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CT09MRUFOLA0KICAgICAgICAgIHRleHQ6ICdbZGF0YV0gZml0cyBvbiBzZXJ2ZXI/JywNCiAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgIGRhdGE6IHsNCiAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLA0KICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdkYXRhJywNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG9wY29kZTogJ2RlbGV0ZUZyb21TZXJ2ZXInLA0KICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwNCiAgICAgICAgICB0ZXh0OiAnZGVsZXRlIFt2YXJpYWJsZU5hbWVdJywNCiAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgIHZhcmlhYmxlTmFtZTogew0KICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ2RhdGEudHh0JywNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIG9wY29kZTogJ2V4aXN0c09uU2VydmVyJywNCiAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sDQogICAgICAgICAgdGV4dDogJ1t2YXJpYWJsZU5hbWVdIGV4aXN0cz8nLA0KICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgdmFyaWFibGVOYW1lOiB7DQogICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnZGF0YS50eHQnLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICB9LA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICB9Ow0KICB9DQoNCiAgc2F2ZVRvU2VydmVyKGFyZ3MsIHV0aWwpIHsNCiAgICBjb25zdCB2YXJpYWJsZU5hbWUgPSBhcmdzLnZhcmlhYmxlTmFtZTsNCiAgICBjb25zdCBjb250ZW50ID0gYXJncy5jb250ZW50Ow0KDQogICAgY29uc3QgdXJsID0NCiAgICAgIHRoaXMuc2VydmVyVVJMICsNCiAgICAgICc/dHlwZT13cml0ZScgKw0KICAgICAgJyZjb250ZW50PScgKw0KICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KGNvbnRlbnQpICsNCiAgICAgICcmZmlsZW5hbWU9Li90ZXh0ZmlsZXMvJyArDQogICAgICBlbmNvZGVVUklDb21wb25lbnQodmFyaWFibGVOYW1lKTsNCg0KICAgIHJldHVybiBmZXRjaCh1cmwpDQogICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpDQogICAgICAudGhlbihyZXN1bHQgPT4gKHJlc3VsdCA9PT0gJ29rJykpDQogICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc2F2ZSBkYXRhOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfSk7DQogIH0NCg0KICBsb2FkRnJvbVNlcnZlcihhcmdzLCB1dGlsKSB7DQogICAgY29uc3QgdmFyaWFibGVOYW1lID0gYXJncy52YXJpYWJsZU5hbWU7DQoNCiAgICBjb25zdCB1cmwgPQ0KICAgICAgdGhpcy5zZXJ2ZXJVUkwgKw0KICAgICAgJz90eXBlPXJlYWQnICsNCiAgICAgICcmZmlsZW5hbWU9Li90ZXh0ZmlsZXMvJyArDQogICAgICBlbmNvZGVVUklDb21wb25lbnQodmFyaWFibGVOYW1lKTsNCg0KICAgIHJldHVybiBmZXRjaCh1cmwpDQogICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpDQogICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBkYXRhOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuICJjYW4ndCBnZXQgZGF0YSI7DQogICAgICB9KTsNCiAgfQ0KDQogIGZpdHMoYXJncywgdXRpbCkgew0KICAgIHJldHVybiBhcmdzLmRhdGEubGVuZ3RoIDwgMTAwMDE7DQogIH0NCg0KICBkZWxldGVGcm9tU2VydmVyKGFyZ3MsIHV0aWwpIHsNCiAgICBjb25zdCB2YXJpYWJsZU5hbWUgPSBhcmdzLnZhcmlhYmxlTmFtZTsNCg0KICAgIGNvbnN0IHVybCA9DQogICAgICB0aGlzLnNlcnZlclVSTCArDQogICAgICAnP3R5cGU9ZGVsZXRlJyArDQogICAgICAnJmZpbGVuYW1lPS4vdGV4dGZpbGVzLycgKw0KICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KHZhcmlhYmxlTmFtZSk7DQoNCiAgICByZXR1cm4gZmV0Y2godXJsKQ0KICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKQ0KICAgICAgLnRoZW4ocmVzdWx0ID0+IChyZXN1bHQgPT09ICdvaycpKQ0KICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGRlbGV0ZSBkYXRhOicsIGVycm9yKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgfSk7DQogIH0NCg0KICBleGlzdHNPblNlcnZlcihhcmdzLCB1dGlsKSB7DQogICAgY29uc3QgdmFyaWFibGVOYW1lID0gYXJncy52YXJpYWJsZU5hbWU7DQoNCiAgICBjb25zdCB1cmwgPQ0KICAgICAgdGhpcy5zZXJ2ZXJVUkwgKw0KICAgICAgJz90eXBlPWV4aXN0cycgKw0KICAgICAgJyZmaWxlbmFtZT0uL3RleHRmaWxlcy8nICsNCiAgICAgIGVuY29kZVVSSUNvbXBvbmVudCh2YXJpYWJsZU5hbWUpOw0KDQogICAgcmV0dXJuIGZldGNoKHVybCkNCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLnRleHQoKSkNCiAgICAgIC50aGVuKHJlc3VsdCA9PiAocmVzdWx0ID09PSAnZXhpc3RzJykpDQogICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2hlY2sgZXhpc3RlbmNlIG9mIGRhdGE6JywgZXJyb3IpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9KTsNCiAgfQ0KfQ0KDQpTY3JhdGNoLmV4dGVuc2lvbnMucmVnaXN0ZXIobmV3IFNlcnZlckV4dGVuc2lvbigpKTsNCg==","sipctime":"https://extensions.turbowarp.org/-SIPC-/time.js","strings":"https://extensions.turbowarp.org/text.js","utilities":"https://extensions.turbowarp.org/utilities.js","0znzwMoreFields":"data:text/javascript;base64,LyohDQogKiBDcmVhdGVkIGJ5IDB6bnp3IHwgdjEuMw0KICogTGljZW5zZWQgVW5kZXIgTUlUICYgTEdQTHYzIExpY2Vuc2UuDQogKiBETyBOT1QgUkVNT1ZFIFRISVMgQ09NTUVOVA0KICovDQooYXN5bmMgZnVuY3Rpb24gKFNjcmF0Y2gpIHsNCiAgJ3VzZSBzdHJpY3QnOw0KDQogIGlmICghU2NyYXRjaC5leHRlbnNpb25zLnVuc2FuZGJveGVkKSB7DQogICAgdGhyb3cgbmV3IEVycm9yKGAiTW9yZSBGaWVsZHMiIG11c3QgYmUgcmFuIHVuc2FuZGJveGVkLmApOw0KICB9DQoNCiAgY29uc3Qgdm0gPSBTY3JhdGNoLnZtOw0KICBjb25zdCBydW50aW1lID0gdm0ucnVudGltZTsNCiAgY29uc3QgaGFzT3duID0gKG9iamVjdCwgcHJvcGVydHkpID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsNCg0KICAvLyBTb21lIGNoZWNrcw0KICBjb25zdCBET09NY2hlY2sgPSAodm0ucnVudGltZS5pb0RldmljZXMudXNlckRhdGEuX3VzZXJuYW1lID09PSAnRE9PTTE5OTcnKTsNCiAgLy8gSURLIG1heWJlIHRoZXkgYXJlIG5vdCBvbiB3ZWIgb3Igc210aCAob3Igd2Via2l0IGNhdXNlIHllYWgpLg0KICBjb25zdCBfVVJMU2VhcmNoUGFyYW1zID0gKHdpbmRvdy5VUkxTZWFyY2hQYXJhbXMgPz8gY2xhc3Mgew0KICAgIGhhcygpIHtyZXR1cm4oZmFsc2UpfQ0KICAgIGdldCgpIHtyZXR1cm4oJycpfTsNCiAgfSk7DQogIGNvbnN0IHNlYXJjaFBhcmFtcyA9IG5ldyBfVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpOw0KICBjb25zdCBoaWRlSW5saW5lVGV4dGFyZWEgPSAhc2VhcmNoUGFyYW1zLmhhcygnTW9yZUZpZWxkc19JbmxpbmVUZXh0YXJlYScpOw0KDQogIC8vICJDb25zdGFudHMiDQogIGNvbnN0IGN1c3RvbUZpZWxkVHlwZXMgPSB7fTsNCiAgbGV0IEJsb2NrbHkgPSBudWxsOyAvLyBCbG9ja2x5IGlzIHVzZWQgY2F1c2UgSXRzIGVhc2llciB0aGFuIFNjcmF0Y2hCbG9ja3MgaW1vLCBpdCBkb2VzIG5vdCBtYWtlIGEgZGlmZmVyZW5jZS4NCg0KICAvLyBNZSBiZWluZyBsYXp5DQogIGZ1bmN0aW9uIF9zZXRDc3NOYXR0cihub2RlLCBhdHRyLCB2YWx1ZSkgew0KICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHIsIFN0cmluZyh2YWx1ZSkpOw0KICAgIG5vZGUuc3R5bGVbYXR0cl0gPSB2YWx1ZTsNCiAgfQ0KICBmdW5jdGlvbiBfZGVsQ3NzTmF0dHIobm9kZSwgYXR0cikgew0KICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHIpOw0KICAgIGRlbGV0ZSBub2RlLnN0eWxlW2F0dHJdOw0KICB9DQoNCiAgLy8gVGhlc2Ugc2hvdWxkIE5FVkVSIGJlIGNhbGxlZCB3aXRob3V0IFNjcmF0Y2hCbG9ja3MgZXhpc3RpbmcNCiAgZnVuY3Rpb24gX2ZpeENvbG91cnMoZG9UZXh0LCBjb2wxLCB0ZXh0Q29sb3IpIHsNCiAgICBjb25zdCBMREEgPSAtMTA7DQogICAgY29uc3QgTERDID0gQmxvY2tseS5fTGlnaHRlbkRhcmtlbkNvbG9yOw0KICAgIGNvbnN0IHNlbGYgPSB0aGlzLnNvdXJjZUJsb2NrXzsNCiAgICBjb25zdCBwYXJlbnQgPSBzZWxmPy5wYXJlbnRCbG9ja187DQogICAgaWYgKCFwYXJlbnQpIHJldHVybjsNCiAgICBjb25zdCBwYXRoID0gc2VsZj8uc3ZnUGF0aF87DQogICAgY29uc3QgYXJndW1lbnRTdmcgPSBwYXRoPy5wYXJlbnROb2RlOw0KICAgIGNvbnN0IHRleHROb2RlID0gYXJndW1lbnRTdmcucXVlcnlTZWxlY3RvcignZy5ibG9ja2x5RWRpdGFibGVUZXh0IHRleHQnKTsNCiAgICBjb25zdCBvbGRGaXJzdENvbG91ciA9IHBhcmVudC5jb2xvdXJfOw0KICAgIHNlbGYuY29sb3VyXyA9IChjb2wxID8/IExEQyhwYXJlbnQuY29sb3VyXywgTERBKSk7DQogICAgc2VsZi5jb2xvdXJTZWNvbmRhcnlfID0gTERDKHBhcmVudC5jb2xvdXJTZWNvbmRhcnlfLCBMREEpOw0KICAgIHNlbGYuY29sb3VyVGVydGlhcnlfID0gTERDKHBhcmVudC5jb2xvdXJUZXJ0aWFyeV8sIExEQSk7DQogICAgc2VsZi5jb2xvdXJRdWF0ZXJuYXJ5XyA9IExEQyhwYXJlbnQ/LmNvbG91clF1YXRlcm5hcnlfID8/IG9sZEZpcnN0Q29sb3VyLCBMREEpOw0KICAgIF9zZXRDc3NOYXR0cihwYXRoLCAnZmlsbCcsIHNlbGYuY29sb3VyXyk7DQogICAgX3NldENzc05hdHRyKHBhdGgsICdzdHJva2UnLCBzZWxmLmNvbG91clRlcnRpYXJ5Xyk7DQogICAgaWYgKGRvVGV4dCAmJiB0ZXh0Tm9kZSkgX3NldENzc05hdHRyKHRleHROb2RlLCAnZmlsbCcsIHRleHRDb2xvciA/PyAnI0ZGRkZGRicpOw0KICB9DQogIGZ1bmN0aW9uIF9tb3ZlRHJvcGRvd24odG9Bcmd1bWVudCkgew0KICAgIHRvQXJndW1lbnQgPSB0b0FyZ3VtZW50ID8/IGZhbHNlOw0KICAgIEJsb2NrbHkuRHJvcERvd25EaXYuc2hvd1Bvc2l0aW9uZWRCeUJsb2NrKHRoaXMsICh0b0FyZ3VtZW50ID8gdGhpcy5zb3VyY2VCbG9ja18gOiB0aGlzLnNvdXJjZUJsb2NrXy5wYXJlbnRCbG9ja18pKTsNCiAgfQ0KICBmdW5jdGlvbiBfZGlzYWJsZVJlcG9ydGVycygpIHsNCiAgICBjb25zdCBibG9jayA9IHRoaXM/LnNvdXJjZUJsb2NrXz8ucGFyZW50QmxvY2tfOw0KICAgIGlmICghYmxvY2spIHJldHVybjsNCiAgICAvLyAiaSIgaXMgdGhlIGluZGV4IGluIGJsb2NrLmlucHV0TGlzdCBvZiB0aGUgY3VycmVudCByZW5kZXJlZCBjb25uZWN0aW9uDQogICAgLy8gdG9kbzogZml4IHRoZSBpbmRleCBjYXVzZSBpdHMgYWx3YXlzIHRoZSBsYXN0IGlucHV0IDpza3VsbDoNCiAgICBsZXQgaSA9IC0xLCBmb3VuZCA9IGZhbHNlOw0KICAgIGJsb2NrLmlucHV0TGlzdC5maW5kKGlucHV0ID0+IHsNCiAgICAgIGlmIChmb3VuZCkgcmV0dXJuIGZhbHNlOw0KICAgICAgZm91bmQgPSAoaW5wdXQuY29ubmVjdGlvbiA9PSB0aGlzIHx8IGlucHV0ID09IHRoaXMuc291cmNlQmxvY2tfKTsNCiAgICAgIGkrKzsNCiAgICAgIHJldHVybiBmb3VuZDsNCiAgICB9KTsNCiAgICBjb25zdCBjb25uZWN0aW9uID0gYmxvY2suaW5wdXRMaXN0Py5baV0/LmNvbm5lY3Rpb247DQogICAgaWYgKGkgPCAwIHx8ICFjb25uZWN0aW9uKSByZXR1cm47DQogICAgLy8gTG1hbyB5b3VyIHdyb25nLg0KICAgIGNvbm5lY3Rpb24uY2hlY2tfID0gW107DQogIH0NCg0KICAvLyBodHRwczovL2dpdGh1Yi5jb20vWGVsdGFsbGl2L2V4dGVuc2lvbnMvYmxvYi9leGFtcGxlcy9leGFtcGxlcy9jdXN0b20tZmllbGQtdHlwZXMuanMNCiAgY29uc3QgYmNmaSA9IHJ1bnRpbWUuX2J1aWxkQ3VzdG9tRmllbGRJbmZvLmJpbmQocnVudGltZSk7DQogIGNvbnN0IGJjZnRmc2IgPSBydW50aW1lLl9idWlsZEN1c3RvbUZpZWxkVHlwZUZvclNjcmF0Y2hCbG9ja3MuYmluZChydW50aW1lKTsNCiAgbGV0IGZpID0gbnVsbDsNCiAgcnVudGltZS5fYnVpbGRDdXN0b21GaWVsZEluZm8gPSBmdW5jdGlvbiAoZmllbGROYW1lLCBmaWVsZEluZm8sIGV4dGVuc2lvbklkLCBjYXRlZ29yeUluZm8pIHsNCiAgICBmaSA9IGZpZWxkSW5mbzsNCiAgICByZXR1cm4gYmNmaShmaWVsZE5hbWUsIGZpZWxkSW5mbywgZXh0ZW5zaW9uSWQsIGNhdGVnb3J5SW5mbyk7DQogIH07DQogIHJ1bnRpbWUuX2J1aWxkQ3VzdG9tRmllbGRUeXBlRm9yU2NyYXRjaEJsb2NrcyA9IGZ1bmN0aW9uIChmaWVsZE5hbWUsIG91dHB1dCwgb3V0cHV0U2hhcGUsIGNhdGVnb3J5SW5mbykgew0KICAgIGxldCByZXMgPSBiY2Z0ZnNiKGZpZWxkTmFtZSwgb3V0cHV0LCBvdXRwdXRTaGFwZSwgY2F0ZWdvcnlJbmZvKTsNCiAgICBpZiAoZmkpIHsNCiAgICAgIGlmIChmaS5jb2xvcjEpIHJlcy5qc29uLmNvbG91ciA9IGZpLmNvbG9yMTsNCiAgICAgIGlmIChmaS5jb2xvcjIpIHJlcy5qc29uLmNvbG91clNlY29uZGFyeSA9IGZpLmNvbG9yMjsNCiAgICAgIGlmIChmaS5jb2xvcjMpIHJlcy5qc29uLmNvbG91clRlcnRpYXJ5ID0gZmkuY29sb3IzOw0KICAgICAgaWYgKGhhc093bihmaSwgJ291dHB1dCcpKSByZXMuanNvbi5vdXRwdXQgPSBmaS5vdXRwdXQ7DQogICAgICBmaSA9IG51bGw7DQogICAgfQ0KICAgIHJldHVybiByZXM7DQogIH07DQoNCiAgY29uc3QgdG9SZWdpc3Rlck9uQmxvY2tseUdvdCA9IFtdOw0KDQogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9MTEsvc2NyYXRjaC12bS9ibG9iL2Y0MDVlNTlkMDFhOGY5YzBlM2U5ODZmYjUyNzY2NjdhOGEzYzdkNDAvdGVzdC91bml0L2V4dGVuc2lvbl9jb252ZXJzaW9uLmpzI0w4NS1MMTI0DQogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9MTEsvc2NyYXRjaC12bS9jb21taXQvY2VhYTNjNzg1N2I3OTQ1OWNjZDFiMTRkNTQ4NTI4ZTQ1MTEyMDllNw0KICB2bS5hZGRMaXN0ZW5lcignRVhURU5TSU9OX0ZJRUxEX0FEREVEJywgKGZpZWxkSW5mbykgPT4gew0KICAgIGNvbnNvbGUubG9nKCdFWFRFTlNJT05fRklFTERfQURERUQnLCBmaWVsZEluZm8sIEJsb2NrbHkpOw0KICAgIGlmIChCbG9ja2x5KSBCbG9ja2x5LkZpZWxkLnJlZ2lzdGVyKGZpZWxkSW5mby5uYW1lLCBmaWVsZEluZm8uaW1wbGVtZW50YXRpb24pOw0KICAgIGVsc2UgdG9SZWdpc3Rlck9uQmxvY2tseUdvdC5wdXNoKFtmaWVsZEluZm8ubmFtZSwgZmllbGRJbmZvLmltcGxlbWVudGF0aW9uXSk7DQogIH0pOw0KDQogIC8vIEFyZ3VtZW50VHlwZSBhZGRpdGlvbnMNCiAgU2NyYXRjaC5Bcmd1bWVudFR5cGUuVEVYVEFSRUEgPSAnVGV4dGFyZWFJbnB1dCc7DQogIFNjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVRFWFRBUkVBID0gJ1RleHRhcmVhSW5wdXRJbmxpbmUnOw0KICBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TTkFQQk9PTEVBTiA9ICdTbmFwQm9vbGVhbic7DQogIFNjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVNMSURFUiA9ICdTbGlkZXJJbmxpbmUnOw0KICBTY3JhdGNoLkFyZ3VtZW50VHlwZS5ISURERU5TVFJJTkcgPSAnU3RyaW5nSGlkZGVuJzsNCiAgU2NyYXRjaC5Bcmd1bWVudFR5cGUuSU5MSU5FREFURSA9ICdEYXRlSW5saW5lJzsNCiAgU2NyYXRjaC5Bcmd1bWVudFR5cGUuRklMRSA9ICdGaWxlSW5wdXQnOw0KDQogDQogIGxldCBpbXBsZW1lbnRhdGlvbnMgPSB7DQogICAgRmllbGRUZXh0YXJlYTogbnVsbCwNCiAgICBGaWVsZElubGluZVRleHRhcmVhOiBudWxsLA0KICAgIEZpZWxkU25hcEJvb2xlYW46IG51bGwsDQogICAgRmllbGRJbmxpbmVTbGlkZXI6IG51bGwsDQogICAgRmllbGRJbmxpbmVEYXRlOiBudWxsLA0KICAgIEZpZWxkRmlsZUlucHV0OiBudWxsLA0KICAgIEZpZWxkSW5saW5lRG9vbTogbnVsbCwNCiAgfTsNCg0KICBjdXN0b21GaWVsZFR5cGVzW1NjcmF0Y2guQXJndW1lbnRUeXBlLlRFWFRBUkVBXSA9IHsNCiAgICBvdXRwdXQ6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICBjb2xvcjE6ICcjOTU2NmQzJywNCiAgICBvdXRwdXRTaGFwZTogMiwNCiAgICBpbXBsZW1lbnRhdGlvbjogew0KICAgICAgZnJvbUpzb246ICgpID0+IG5ldyBpbXBsZW1lbnRhdGlvbnMuRmllbGRUZXh0YXJlYSgpDQogICAgfQ0KICB9Ow0KICBjdXN0b21GaWVsZFR5cGVzW1NjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVRFWFRBUkVBXSA9IHsNCiAgICBvdXRwdXQ6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywNCiAgICBjb2xvcjE6ICcjOTU2NmQzJywNCiAgICBvdXRwdXRTaGFwZTogMiwNCiAgICBpbXBsZW1lbnRhdGlvbjogew0KICAgICAgZnJvbUpzb246ICgpID0+IG5ldyBpbXBsZW1lbnRhdGlvbnMuRmllbGRJbmxpbmVUZXh0YXJlYSgpDQogICAgfQ0KICB9Ow0KICBjdXN0b21GaWVsZFR5cGVzW1NjcmF0Y2guQXJndW1lbnRUeXBlLlNOQVBCT09MRUFOXSA9IHsNCiAgICBvdXRwdXQ6IFNjcmF0Y2guQXJndW1lbnRUeXBlLkJPT0xFQU4sDQogICAgY29sb3IxOiAnIzk1NjZkMycsDQogICAgb3V0cHV0U2hhcGU6IDEsDQogICAgaW1wbGVtZW50YXRpb246IHsNCiAgICAgIGZyb21Kc29uOiAoKSA9PiBuZXcgaW1wbGVtZW50YXRpb25zLkZpZWxkU25hcEJvb2xlYW4oKQ0KICAgIH0NCiAgfTsNCiAgY3VzdG9tRmllbGRUeXBlc1tTY3JhdGNoLkFyZ3VtZW50VHlwZS5JTkxJTkVTTElERVJdID0gew0KICAgIG91dHB1dDogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLA0KICAgIGNvbG9yMTogJyM5NTY2ZDMnLA0KICAgIG91dHB1dFNoYXBlOiAzLA0KICAgIGltcGxlbWVudGF0aW9uOiB7DQogICAgICBmcm9tSnNvbjogKCkgPT4gbmV3IGltcGxlbWVudGF0aW9ucy5GaWVsZElubGluZVNsaWRlcigpDQogICAgfQ0KICB9Ow0KICBjdXN0b21GaWVsZFR5cGVzW1NjcmF0Y2guQXJndW1lbnRUeXBlLkhJRERFTlNUUklOR10gPSB7DQogICAgb3V0cHV0OiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsDQogICAgY29sb3IxOiAnIzk1NjZkMycsDQogICAgb3V0cHV0U2hhcGU6IDIsDQogICAgaW1wbGVtZW50YXRpb246IHsNCiAgICAgIGZyb21Kc29uOiAoKSA9PiBuZXcgaW1wbGVtZW50YXRpb25zLkZpZWxkSGlkZGVuVGV4dElucHV0KCkNCiAgICB9DQogIH07DQogIGN1c3RvbUZpZWxkVHlwZXNbU2NyYXRjaC5Bcmd1bWVudFR5cGUuSU5MSU5FREFURV0gPSB7DQogICAgb3V0cHV0OiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsDQogICAgY29sb3IxOiAnIzk1NjZkMycsDQogICAgb3V0cHV0U2hhcGU6IDMsDQogICAgaW1wbGVtZW50YXRpb246IHsNCiAgICAgIGZyb21Kc29uOiAoKSA9PiBuZXcgaW1wbGVtZW50YXRpb25zLkZpZWxkSW5saW5lRGF0ZSgpDQogICAgfQ0KICB9Ow0KICBjdXN0b21GaWVsZFR5cGVzW1NjcmF0Y2guQXJndW1lbnRUeXBlLkZJTEVdID0gew0KICAgIG91dHB1dDogbnVsbCwNCiAgICBjb2xvcjE6ICcjOTU2NmQzJywNCiAgICBvdXRwdXRTaGFwZTogMywNCiAgICBpbXBsZW1lbnRhdGlvbjogew0KICAgICAgZnJvbUpzb246ICgpID0+IG5ldyBpbXBsZW1lbnRhdGlvbnMuRmllbGRGaWxlSW5wdXQoKQ0KICAgIH0NCiAgfTsNCiAgY3VzdG9tRmllbGRUeXBlc1snSW5saW5lRG9vbSddID0gew0KICAgIG91dHB1dDogW10sDQogICAgY29sb3IxOiAnIzk1NjZkMycsDQogICAgb3V0cHV0U2hhcGU6IDMsDQogICAgaW1wbGVtZW50YXRpb246IHsNCiAgICAgIGZyb21Kc29uOiAoKSA9PiBuZXcgaW1wbGVtZW50YXRpb25zLkZpZWxkSW5saW5lRG9vbSgpDQogICAgfQ0KICB9Ow0KDQogIC8vIE1haW4gdHJ5IHRoaW5nDQogIGZ1bmN0aW9uIHRyeVVzZVNjcmF0Y2hCbG9ja3MoX3NiKSB7DQogICAgY29uc29sZS5sb2coJ0dvdCBTY3JhdGNoQmxvY2tzJywgX3NiKTsNCg0KICAgIEJsb2NrbHkgPSBfc2I7DQogICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTU2MDI0OC9wcm9ncmFtbWF0aWNhbGx5LWxpZ2h0ZW4tb3ItZGFya2VuLWEtaGV4LWNvbG9yLW9yLXJnYi1hbmQtYmxlbmQtY29sb3JzDQogICAgQmxvY2tseS5fTGlnaHRlbkRhcmtlbkNvbG9yID0gZnVuY3Rpb24oY29sLCBhbXQpIHsNCiAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KGNvbC5yZXBsYWNlKCcjJywgJycpLCAxNik7DQogICAgICBjb25zdCByID0gKG51bSA+PiAxNikgKyBhbXQ7DQogICAgICBjb25zdCBiID0gKChudW0gPj4gOCkgJiAweDAwRkYpICsgYW10Ow0KICAgICAgY29uc3QgZyA9IChudW0gJiAweDAwMDBGRikgKyBhbXQ7DQogICAgICBjb25zdCBuZXdDb2xvciA9IGcgfCAoYiA8PCA4KSB8IChyIDw8IDE2KTsNCiAgICAgIHJldHVybiAoY29sLmF0KDApID09PSAnIycgPyAnIycgOiAnJykgKyBuZXdDb2xvci50b1N0cmluZygxNik7DQogICAgfQ0KDQogICAgLy8gUGF0Y2ggZm9yIGEgYnVnIGluIHNpemVfLmhlaWdodA0KICAgIGNvbnN0IF9lbmRCbG9ja0RyYWcgPSBCbG9ja2x5LkJsb2NrRHJhZ2dlci5wcm90b3R5cGUuZW5kQmxvY2tEcmFnDQogICAgQmxvY2tseS5CbG9ja0RyYWdnZXIucHJvdG90eXBlLmVuZEJsb2NrRHJhZyA9IGZ1bmN0aW9uICguLi5hKSB7DQogICAgICBfZW5kQmxvY2tEcmFnLmNhbGwodGhpcywgLi4uYSk7DQogICAgICBmb3IgKGNvbnN0IGNoaWxkQmxvY2sgb2YgdGhpcy5kcmFnZ2luZ0Jsb2NrXy5jaGlsZEJsb2Nrc18pIHsNCiAgICAgICAgY29uc3QgaW5wdXRMaXN0ID0gY2hpbGRCbG9jay5pbnB1dExpc3Q7DQogICAgICAgIGlmIChpbnB1dExpc3QubGVuZ3RoID09PSAxICYmIGlucHV0TGlzdFswXS5maWVsZFJvdy5sZW5ndGggPT09IDEgJiYgISFpbnB1dExpc3RbMF0uZmllbGRSb3dbMF0/LmlubGluZURibFJlbmRlcikgY2hpbGRCbG9jay5yZW5kZXIoKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBGaWVsZHMNCiAgICBjb25zdCB0ZXh0SW5wdXRzX3RydWVUb09yaWdpbmFsID0gdHJ1ZTsNCiAgICBpbXBsZW1lbnRhdGlvbnMuRmllbGRUZXh0YXJlYSA9IGNsYXNzIEZpZWxkVGV4dGFyZWEgZXh0ZW5kcyBCbG9ja2x5LkZpZWxkVGV4dElucHV0IHsNCiAgICAgIGNvbnN0cnVjdG9yKG9wdF92YWx1ZSkgew0KICAgICAgICBvcHRfdmFsdWUgPSBTY3JhdGNoLkFyZ3VtZW50VHlwZS5URVhUQVJFQTsNCiAgICAgICAgc3VwZXIob3B0X3ZhbHVlKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKCdTdHJpbmcnKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKFNjcmF0Y2guQXJndW1lbnRUeXBlLlRFWFRBUkVBKTsNCiAgICAgIH0NCiAgICAgIHNob3dFZGl0b3JfKCkgew0KICAgICAgICBCbG9ja2x5LkRyb3BEb3duRGl2LmNsZWFyQ29udGVudCgpOw0KICAgICAgICBjb25zdCBkaXYgPSBCbG9ja2x5LkRyb3BEb3duRGl2LmdldENvbnRlbnREaXYoKTsNCiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpOw0KICAgICAgICBpbnB1dC52YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTsNCiAgICAgICAgZGl2LmFwcGVuZChpbnB1dCk7DQogICAgICAgIHRoaXMuX3RleHRhcmVhID0gaW5wdXQ7DQogICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5fb25JbnB1dCgpKTsNCiAgICAgICAgQmxvY2tseS5Ecm9wRG93bkRpdi5zZXRDb2xvdXIodGhpcy5zb3VyY2VCbG9ja18ucGFyZW50QmxvY2tfLmdldENvbG91cigpLCB0aGlzLnNvdXJjZUJsb2NrXy5wYXJlbnRCbG9ja18uZ2V0Q29sb3VyVGVydGlhcnkoKSk7DQogICAgICAgIEJsb2NrbHkuRHJvcERvd25EaXYuc2V0Q2F0ZWdvcnkodGhpcy5zb3VyY2VCbG9ja18ucGFyZW50QmxvY2tfLmdldENhdGVnb3J5KCkpOw0KICAgICAgICBfbW92ZURyb3Bkb3duLmNhbGwodGhpcyk7DQogICAgICB9DQogICAgICBpbml0KC4uLmluaXRBcmdzKSB7DQogICAgICAgIEJsb2NrbHkuRmllbGQucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzLCAuLi5pbml0QXJncyk7DQogICAgICAgIHRoaXMuc291cmNlQmxvY2tfLm91dHB1dENvbm5lY3Rpb24uY2hlY2tfID0gW107DQogICAgICAgIF9maXhDb2xvdXJzLmNhbGwodGhpcywgIXRleHRJbnB1dHNfdHJ1ZVRvT3JpZ2luYWwsICh0ZXh0SW5wdXRzX3RydWVUb09yaWdpbmFsID8gJyNGRkZGRkYnIDogdW5kZWZpbmVkKSwgJyNGRkZGRkYnKTsNCiAgICAgIH0NCiAgICAgIF9vbklucHV0KCkgew0KICAgICAgICB0aGlzLnNldFZhbHVlKHRoaXMuX3RleHRhcmVhLnZhbHVlKTsNCiAgICAgICAgX21vdmVEcm9wZG93bi5jYWxsKHRoaXMpOw0KICAgICAgfQ0KICAgIH0NCiAgICBpbXBsZW1lbnRhdGlvbnMuRmllbGRJbmxpbmVUZXh0YXJlYSA9IGNsYXNzIEZpZWxkSW5saW5lVGV4dGFyZWEgZXh0ZW5kcyBCbG9ja2x5LkZpZWxkIHsNCiAgICAgIGNvbnN0cnVjdG9yKG9wdF92YWx1ZSkgew0KICAgICAgICBvcHRfdmFsdWUgPSBTY3JhdGNoLkFyZ3VtZW50VHlwZS5JTkxJTkVURVhUQVJFQTsNCiAgICAgICAgc3VwZXIob3B0X3ZhbHVlKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKCdTdHJpbmcnKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKFNjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVRFWFRBUkVBKTsNCiAgICAgIH0NCiAgICAgIHVwZGF0ZVdpZHRoKCkgew0KICAgICAgICB0aGlzLnNpemVfLndpZHRoID0gdGhpcy5fRmFrZVdpZHRoOw0KICAgICAgICB0aGlzLnNpemVfLmhlaWdodCA9IHRoaXMuX0Zha2VIZWlnaHQ7DQogICAgICB9DQogICAgICBpbml0KC4uLmluaXRBcmdzKSB7DQogICAgICAgIHRoaXMuaW5saW5lRGJsUmVuZGVyID0gdHJ1ZTsNCiAgICAgICAgQmxvY2tseS5GaWVsZC5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMsIC4uLmluaXRBcmdzKTsNCiAgICAgICAgX2Rpc2FibGVSZXBvcnRlcnMuY2FsbCh0aGlzKTsNCiAgICAgICAgdGhpcy50ZXh0Tm9kZV9fID0gdGhpcy5zb3VyY2VCbG9ja18uc3ZnUGF0aF8ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCdnLmJsb2NrbHlFZGl0YWJsZVRleHQgdGV4dCcpOw0KICAgICAgICBpZiAoISF0aGlzLnRleHROb2RlX18pIHsNCiAgICAgICAgICB0aGlzLnRleHROb2RlX18uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICBfZml4Q29sb3Vycy5jYWxsKHRoaXMsIGZhbHNlLCB0aGlzLnNvdXJjZUJsb2NrXy5wYXJlbnRCbG9ja18uY29sb3VyXyk7DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5fRmFrZVdpZHRoID0gdGhpcy5fRmFrZVdpZHRoID8/IDQwOw0KICAgICAgICB0aGlzLl9GYWtlSGVpZ2h0ID0gdGhpcy5fRmFrZUhlaWdodCA/PyAyMDsNCiAgICAgICAgY29uc3QgdGV4dGFyZWFIb2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2ZvcmVpZ25PYmplY3QnKTsNCiAgICAgICAgdGV4dGFyZWFIb2xkZXIuc2V0QXR0cmlidXRlKCd4JywgJzE2Jyk7DQogICAgICAgIHRleHRhcmVhSG9sZGVyLnNldEF0dHJpYnV0ZSgneScsICc4Jyk7DQogICAgICAgIHRleHRhcmVhSG9sZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgICAgICAgY29uc3QgdGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpOw0KICAgICAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHRoaXMuX29uSW5wdXQoKSk7DQogICAgICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoZSkgPT4gdGhpcy5fcmVzaXplSG9sZGVyKCkpOw0KICAgICAgICBpZiAodGhpcy5maWVsZEdyb3VwXykgew0KICAgICAgICAgIHRoaXMuZmllbGRHcm91cF8uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsIHRleHRhcmVhSG9sZGVyKTsNCiAgICAgICAgICB0ZXh0YXJlYUhvbGRlci5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7DQogICAgICAgICAgdGhpcy5fdGV4dGFyZWFIb2xkZXIgPSB0ZXh0YXJlYUhvbGRlcjsNCiAgICAgICAgICB0aGlzLl90ZXh0YXJlYSA9IHRleHRhcmVhOw0KICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUJsb2NrXyAmJiB0aGlzLnNvdXJjZUJsb2NrXy5pc0luRmx5b3V0KSB7DQogICAgICAgICAgICB0ZXh0YXJlYS5kaXNhYmxlZCA9IHRydWU7DQogICAgICAgICAgICB0ZXh0YXJlYS5zdHlsZS5yZXNpemUgPSAnbm9uZSc7DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuX3Jlc2l6ZUhvbGRlcigpOw0KICAgICAgICAgIG5ldyBSZXNpemVPYnNlcnZlcigoKSA9PiB0aGlzLl9yZXNpemVIb2xkZXIoKSkub2JzZXJ2ZSh0aGlzLl90ZXh0YXJlYSk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIF9yZXNpemVIb2xkZXIoKSB7DQogICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5fdGV4dGFyZWEub2Zmc2V0V2lkdGggKyAxLCBoZWlnaHQgPSB0aGlzLl90ZXh0YXJlYS5vZmZzZXRIZWlnaHQgKyAxOw0KICAgICAgICB0aGlzLl90ZXh0YXJlYUhvbGRlci5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgU3RyaW5nKHdpZHRoICsgMykpOw0KICAgICAgICB0aGlzLl90ZXh0YXJlYUhvbGRlci5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIFN0cmluZyhoZWlnaHQgKyAzKSk7DQogICAgICAgIHRoaXMuX0Zha2VXaWR0aCA9IHdpZHRoICsgODsNCiAgICAgICAgdGhpcy5fRmFrZUhlaWdodCA9IGhlaWdodCArIDE2Ow0KICAgICAgICB0aGlzLnVwZGF0ZVdpZHRoKCk7DQogICAgICAgIGNvbnN0IG92ID0gdGhpcy5nZXRWYWx1ZSgpOw0KICAgICAgICB0aGlzLnNldFZhbHVlKG92ICsgJ34nKTsNCiAgICAgICAgdGhpcy5zZXRWYWx1ZShvdik7DQogICAgICAgIHRoaXMucmVuZGVyXygpOw0KICAgICAgfQ0KICAgICAgX29uSW5wdXQoKSB7DQogICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5fdGV4dGFyZWEudmFsdWUpOw0KICAgICAgfQ0KICAgICAgc2hvd0VkaXRvcl8oKSB7DQogICAgICB9DQogICAgfQ0KICAgIGltcGxlbWVudGF0aW9ucy5GaWVsZFNuYXBCb29sZWFuID0gY2xhc3MgRmllbGRTbmFwQm9vbGVhbiBleHRlbmRzIEJsb2NrbHkuRmllbGQgew0KICAgICAgY29uc3RydWN0b3Iob3B0X3ZhbHVlKSB7DQogICAgICAgIG9wdF92YWx1ZSA9IE51bWJlcihvcHRfdmFsdWUpOw0KICAgICAgICBzdXBlcihvcHRfdmFsdWUpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoJ0Jvb2xlYW4nKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKFNjcmF0Y2guQXJndW1lbnRUeXBlLlNOQVBCT09MRUFOKTsNCiAgICAgICAgdGhpcy5jaGVja1N5bWJvbCA9IFN0cmluZy5mcm9tQ29kZVBvaW50KCcxMDAwMycpOw0KICAgICAgICB0aGlzLnNsYXAgPSBgJHt0aGlzLmNoZWNrU3ltYm9sfVx1MDBBMFx1MDBBMFx1MDBBMHhgOw0KICAgICAgfQ0KICAgICAgLy8gSW5pdGlhbCBET00gYnVpbGRpbmcuDQogICAgICBpbml0KC4uLmEpIHsNCiAgICAgICAgQmxvY2tseS5GaWVsZC5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMsIC4uLmEpOw0KICAgICAgICBfZGlzYWJsZVJlcG9ydGVycy5jYWxsKHRoaXMpOw0KICAgICAgICBjb25zdCBzbGlkZXJDaXJjbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2NpcmNsZScpOw0KICAgICAgICBzbGlkZXJDaXJjbGUuc2V0QXR0cmlidXRlKCdjeCcsICcwJyk7DQogICAgICAgIHNsaWRlckNpcmNsZS5zZXRBdHRyaWJ1dGUoJ2N5JywgJy01Jyk7DQogICAgICAgIHNsaWRlckNpcmNsZS5zZXRBdHRyaWJ1dGUoJ3InLCAnMTAnKTsNCiAgICAgICAgc2xpZGVyQ2lyY2xlLnNldEF0dHJpYnV0ZSgnZmlsbCcsICd3aGl0ZScpOw0KICAgICAgICBzbGlkZXJDaXJjbGUuc2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDE2LCAxNiknKTsNCiAgICAgICAgdGhpcy5zbGlkZXJDaXJjbGVfID0gc2xpZGVyQ2lyY2xlOw0KICAgICAgICBpZiAodGhpcy5maWVsZEdyb3VwXykgdGhpcy5maWVsZEdyb3VwXy5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgc2xpZGVyQ2lyY2xlKTsNCiAgICAgIH0NCiAgICAgIC8vIENvbG9ycyA8Mw0KICAgICAgcmVyZW5kZXIoKSB7DQogICAgICAgIGNvbnN0IGZnXyA9IHRoaXMuZmllbGRHcm91cF87DQogICAgICAgIGlmICghZmdfKSByZXR1cm47DQogICAgICAgIGNvbnN0IHBhdGggPSBmZ18/LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7DQogICAgICAgIGlmIChwYXRoPy5ub2RlTmFtZSAhPT0gJ3BhdGgnKSByZXR1cm47DQogICAgICAgIGNvbnN0IGNpcmNsZSA9IHRoaXMuc2xpZGVyQ2lyY2xlXzsNCiAgICAgICAgaWYgKE51bWJlcih0aGlzLmdldFZhbHVlKCkpKSB7DQogICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjMjFERDIxJyk7DQogICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnIzIxREQyMScpOw0KICAgICAgICAgIGlmIChjaXJjbGUpIGNpcmNsZS5zZXRBdHRyaWJ1dGUoJ2N4JywgJzI0Jyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICcjRkYzMzMzJyk7DQogICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnI0ZGMzMzMycpOw0KICAgICAgICAgIGlmIChjaXJjbGUpIGNpcmNsZS5zZXRBdHRyaWJ1dGUoJ2N4JywgJzAnKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLy8gU3RhdGUgbWFuYWdlbWVudA0KICAgICAgdXBkYXRlU3RhdGUodmFsdWUsIHRvZ2dsZSkgew0KICAgICAgICBsZXQgbiA9IE51bWJlcih2YWx1ZSk7DQogICAgICAgIGlmICh0b2dnbGUpIG4gPSBOdW1iZXIoIUJvb2xlYW4oTnVtYmVyKHRoaXMuZ2V0VmFsdWUoKSkpKTsNCiAgICAgICAgdGhpcy5zZXRWYWx1ZShuKTsNCiAgICAgIH0NCiAgICAgIHNob3dFZGl0b3JfKCkgew0KICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlKDAsIHRydWUpOw0KICAgICAgICB0aGlzLnJlbmRlcl8oKTsNCiAgICAgIH0NCiAgICAgIC8vIFJlbmRlcmluZw0KICAgICAgcmVuZGVyXygpIHsNCiAgICAgICAgaWYgKHRoaXMudmlzaWJsZV8gJiYgdGhpcy50ZXh0RWxlbWVudF8pIHsNCiAgICAgICAgICAvLyBSZXBsYWNlIHRoZSB0ZXh0Lg0KICAgICAgICAgIHRoaXMudGV4dEVsZW1lbnRfLnRleHRDb250ZW50ID0gdGhpcy5zbGFwOyAvL3RoaXMuZ2V0RGlzcGxheVRleHRfKCk7DQogICAgICAgICAgdGhpcy51cGRhdGVXaWR0aCgpOw0KDQogICAgICAgICAgLy8gVXBkYXRlIHRleHQgY2VudGVyaW5nLCBiYXNlZCBvbiBuZXdseSBjYWxjdWxhdGVkIHdpZHRoLg0KICAgICAgICAgIHZhciBjZW50ZXJUZXh0WCA9ICh0aGlzLnNpemVfLndpZHRoIC0gdGhpcy5hcnJvd1dpZHRoXykgLyAyOw0KICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUJsb2NrXy5SVEwpIHsNCiAgICAgICAgICAgIGNlbnRlclRleHRYICs9IHRoaXMuYXJyb3dXaWR0aF87DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gSW4gYSB0ZXh0LWVkaXRpbmcgc2hhZG93IGJsb2NrJ3MgZmllbGQsDQogICAgICAgICAgLy8gaWYgaGFsZiB0aGUgdGV4dCBsZW5ndGggaXMgbm90IGF0IGxlYXN0IGNlbnRlciBvZg0KICAgICAgICAgIC8vIHZpc2libGUgZmllbGQgKEZJRUxEX1dJRFRIKSwgY2VudGVyIGl0IHRoZXJlIGluc3RlYWQsDQogICAgICAgICAgLy8gdW5sZXNzIHRoZXJlIGlzIGEgZHJvcC1kb3duIGFycm93Lg0KICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUJsb2NrXy5pc1NoYWRvdygpICYmICF0aGlzLnBvc2l0aW9uQXJyb3cpIHsNCiAgICAgICAgICAgIHZhciBtaW5PZmZzZXQgPSBCbG9ja2x5LkJsb2NrU3ZnLkZJRUxEX1dJRFRIIC8gMjsNCiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUJsb2NrXy5SVEwpIHsNCiAgICAgICAgICAgICAgLy8gWCBwb3NpdGlvbiBzdGFydHMgYXQgdGhlIGxlZnQgZWRnZSBvZiB0aGUgYmxvY2ssIGluIGJvdGggUlRMIGFuZCBMVFIuDQogICAgICAgICAgICAgIC8vIEZpcnN0IG9mZnNldCBieSB0aGUgd2lkdGggb2YgdGhlIGJsb2NrIHRvIG1vdmUgdG8gdGhlIHJpZ2h0IGVkZ2UsDQogICAgICAgICAgICAgIC8vIGFuZCB0aGVuIHN1YnRyYWN0IHRvIG1vdmUgdG8gdGhlIHNhbWUgcG9zaXRpb24gYXMgTFRSLg0KICAgICAgICAgICAgICB2YXIgbWluQ2VudGVyID0gdGhpcy5zaXplXy53aWR0aCAtIG1pbk9mZnNldDsNCiAgICAgICAgICAgICAgY2VudGVyVGV4dFggPSBNYXRoLm1pbihtaW5DZW50ZXIsIGNlbnRlclRleHRYKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIC8vICh3aWR0aCAvIDIpIHNob3VsZCBleGNlZWQgQmxvY2tseS5CbG9ja1N2Zy5GSUVMRF9XSURUSCAvIDINCiAgICAgICAgICAgICAgLy8gaWYgdGhlIHRleHQgaXMgbG9uZ2VyLg0KICAgICAgICAgICAgICBjZW50ZXJUZXh0WCA9IE1hdGgubWF4KG1pbk9mZnNldCwgY2VudGVyVGV4dFgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIEFwcGx5IG5ldyB0ZXh0IGVsZW1lbnQgeCBwb3NpdGlvbi4NCiAgICAgICAgICB0aGlzLnRleHRFbGVtZW50Xy5zZXRBdHRyaWJ1dGUoJ3gnLCBjZW50ZXJUZXh0WCk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBVcGRhdGUgYW55IGRyYXduIGJveCB0byB0aGUgY29ycmVjdCB3aWR0aCBhbmQgaGVpZ2h0Lg0KICAgICAgICBpZiAodGhpcy5ib3hfKSB7DQogICAgICAgICAgdGhpcy5ib3hfLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB0aGlzLnNpemVfLndpZHRoKTsNCiAgICAgICAgICB0aGlzLmJveF8uc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLnNpemVfLmhlaWdodCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAodGhpcy50ZXh0RWxlbWVudF8pIHsNCiAgICAgICAgICAvLyB0aGlzLnRleHRFbGVtZW50Xy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICB9DQoNCiAgICAgICAgdGhpcy5yZXJlbmRlcigpOw0KICAgICAgfQ0KICAgIH0NCiAgICBpbXBsZW1lbnRhdGlvbnMuRmllbGRJbmxpbmVTbGlkZXIgPSBjbGFzcyBGaWVsZElubGluZVNsaWRlciBleHRlbmRzIEJsb2NrbHkuRmllbGROdW1iZXIgew0KICAgICAgY29uc3RydWN0b3Iob3B0X3ZhbHVlKSB7DQogICAgICAgIG9wdF92YWx1ZSA9IFNjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVNMSURFUjsNCiAgICAgICAgc3VwZXIob3B0X3ZhbHVlKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKCdOdW1iZXInKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKFNjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVNMSURFUik7DQogICAgICB9DQogICAgICB1cGRhdGVXaWR0aCgpIHsNCiAgICAgICAgdGhpcy5zaXplXy53aWR0aCA9IDEzOTsNCiAgICAgIH0NCiAgICAgIGluaXQoLi4uaW5pdEFyZ3MpIHsNCiAgICAgICAgQmxvY2tseS5GaWVsZE51bWJlci5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMsIC4uLmluaXRBcmdzKTsNCiAgICAgICAgX2Rpc2FibGVSZXBvcnRlcnMuY2FsbCh0aGlzKTsNCiAgICAgICAgdGhpcy50ZXh0Tm9kZV9fID0gdGhpcy5zb3VyY2VCbG9ja18uc3ZnUGF0aF8ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCdnLmJsb2NrbHlFZGl0YWJsZVRleHQgdGV4dCcpOw0KICAgICAgICBpZiAoISF0aGlzLnRleHROb2RlX18pIHsNCiAgICAgICAgICB0aGlzLnRleHROb2RlX18uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICBfZml4Q29sb3Vycy5jYWxsKHRoaXMsIGZhbHNlLCB0aGlzLnNvdXJjZUJsb2NrXy5wYXJlbnRCbG9ja18uY29sb3VyXyk7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFTdHJpbmcodGhpcy5nZXRWYWx1ZSgpKS5pbmNsdWRlcygnLCcpKSB0aGlzLnNldFZhbHVlKGAke3RoaXMuZ2V0VmFsdWUoKX0sJHtOdW1iZXIodGhpcy5nZXRWYWx1ZSgpKS1OdW1iZXIodGhpcy5nZXRWYWx1ZSgpKS8yfSwke051bWJlcih0aGlzLmdldFZhbHVlKCkpK051bWJlcih0aGlzLmdldFZhbHVlKCkpLzJ9YCk7DQogICAgICAgIGNvbnN0IHZhbHMgPSB0aGlzLmdldFZhbHVlKCkuc3BsaXQoJywnKTsNCiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICAgICAgICBpbnB1dC50eXBlID0gJ3JhbmdlJzsNCiAgICAgICAgaW5wdXQudmFsdWUgPSBOdW1iZXIodmFsc1swXSk7DQogICAgICAgIGlucHV0Lm1pbiA9IE51bWJlcih2YWxzWzFdKTsNCiAgICAgICAgaW5wdXQubWF4ID0gTnVtYmVyKHZhbHNbMl0pOw0KICAgICAgICBpbnB1dC53aWR0aCA9IDEzOTsNCiAgICAgICAgaW5wdXQuaGVpZ2h0ID0gMTY7DQogICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5fb25TbGlkZXJJbnB1dCgpKTsNCiAgICAgICAgY29uc3Qgc2xpZGVySG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdmb3JlaWduT2JqZWN0Jyk7DQogICAgICAgIHNsaWRlckhvbGRlci5zZXRBdHRyaWJ1dGUoJ3gnLCAnMTYnKTsNCiAgICAgICAgc2xpZGVySG9sZGVyLnNldEF0dHJpYnV0ZSgneScsICczJyk7DQogICAgICAgIHNsaWRlckhvbGRlci5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzEzOScpOw0KICAgICAgICBzbGlkZXJIb2xkZXIuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMTYnKTsNCiAgICAgICAgc2xpZGVySG9sZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiBlLnN0b3BQcm9wYWdhdGlvbigpKTsNCiAgICAgICAgaWYgKHRoaXMuZmllbGRHcm91cF8pIHRoaXMuZmllbGRHcm91cF8uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsIHNsaWRlckhvbGRlcik7DQogICAgICAgIHNsaWRlckhvbGRlci5hcHBlbmRDaGlsZChpbnB1dCk7DQogICAgICAgIHRoaXMuX3NsaWRlciA9IGlucHV0Ow0KICAgICAgICB0aGlzLl9zbGlkZXJIb2xkZXIgPSBzbGlkZXJIb2xkZXI7DQogICAgICAgIHRoaXMucmVuZGVyXygpOw0KICAgICAgfQ0KICAgICAgX29uSW5wdXQoKSB7DQogICAgICAgIHRoaXMuX3ZhbElucHV0Lm1pbiA9IHRoaXMuX21pbklucHV0LnZhbHVlOw0KICAgICAgICB0aGlzLl92YWxJbnB1dC5tYXggPSB0aGlzLl9tYXhJbnB1dC52YWx1ZTsNCiAgICAgICAgdGhpcy5fc2xpZGVyLnZhbHVlID0gdGhpcy5fdmFsSW5wdXQudmFsdWU7DQogICAgICAgIHRoaXMuX3NsaWRlci5taW4gPSB0aGlzLl9taW5JbnB1dC52YWx1ZTsNCiAgICAgICAgdGhpcy5fc2xpZGVyLm1heCA9IHRoaXMuX21heElucHV0LnZhbHVlOw0KICAgICAgICBjb25zdCB2YWwgPSBgJHt0aGlzLl9zbGlkZXIudmFsdWV9LCR7dGhpcy5fbWluSW5wdXQudmFsdWV9LCR7dGhpcy5fbWF4SW5wdXQudmFsdWV9YDsNCiAgICAgICAgdGhpcy5zZXRWYWx1ZSh2YWwpOw0KICAgICAgfQ0KICAgICAgX29uU2xpZGVySW5wdXQoKSB7DQogICAgICAgIGlmICghIXRoaXMuX3ZhbElucHV0KSB0aGlzLl92YWxJbnB1dC52YWx1ZSA9IE51bWJlcih0aGlzLl9zbGlkZXIudmFsdWUpOw0KICAgICAgICBjb25zdCB2YWwgPSBgJHt0aGlzLl9zbGlkZXIudmFsdWV9LCR7dGhpcy5fc2xpZGVyLm1pbn0sJHt0aGlzLl9zbGlkZXIubWF4fWA7DQogICAgICAgIHRoaXMuc2V0VmFsdWUodmFsKTsNCiAgICAgIH0NCiAgICAgIHNob3dFZGl0b3JfKCkgew0KICAgICAgICBCbG9ja2x5LkRyb3BEb3duRGl2LmNsZWFyQ29udGVudCgpOw0KICAgICAgICBjb25zdCBkaXYgPSBCbG9ja2x5LkRyb3BEb3duRGl2LmdldENvbnRlbnREaXYoKTsNCiAgICAgICAgY29uc3QgbWluSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOw0KICAgICAgICBtaW5JbnB1dC50eXBlID0gJ251bWJlcic7DQogICAgICAgIG1pbklucHV0LnZhbHVlID0gTnVtYmVyKHRoaXMuX3NsaWRlci5taW4pOw0KICAgICAgICBjb25zdCBtYXhJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7DQogICAgICAgIG1heElucHV0LnR5cGUgPSAnbnVtYmVyJzsNCiAgICAgICAgbWF4SW5wdXQudmFsdWUgPSBOdW1iZXIodGhpcy5fc2xpZGVyLm1heCk7DQogICAgICAgIGNvbnN0IHZhbElucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsNCiAgICAgICAgdmFsSW5wdXQudHlwZSA9ICdudW1iZXInOw0KICAgICAgICB2YWxJbnB1dC52YWx1ZSA9IE51bWJlcih0aGlzLl9zbGlkZXIudmFsdWUpOw0KICAgICAgICB2YWxJbnB1dC5taW4gPSBtaW5JbnB1dC52YWx1ZTsNCiAgICAgICAgdmFsSW5wdXQubWF4ID0gbWF4SW5wdXQudmFsdWU7DQogICAgICAgIGRpdi5hcHBlbmQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ01pbjogJykpOw0KICAgICAgICBkaXYuYXBwZW5kKG1pbklucHV0KTsNCiAgICAgICAgZGl2LmFwcGVuZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKTsNCiAgICAgICAgZGl2LmFwcGVuZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnVmFsdWU6ICcpKTsNCiAgICAgICAgZGl2LmFwcGVuZCh2YWxJbnB1dCk7DQogICAgICAgIGRpdi5hcHBlbmQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSk7DQogICAgICAgIGRpdi5hcHBlbmQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ01heDogJykpOw0KICAgICAgICBkaXYuYXBwZW5kKG1heElucHV0KTsNCiAgICAgICAgdGhpcy5fbWluSW5wdXQgPSBtaW5JbnB1dDsNCiAgICAgICAgdGhpcy5fbWF4SW5wdXQgPSBtYXhJbnB1dDsNCiAgICAgICAgdGhpcy5fdmFsSW5wdXQgPSB2YWxJbnB1dDsNCiAgICAgICAgbWluSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB0aGlzLl9vbklucHV0KCkpOw0KICAgICAgICBtYXhJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHRoaXMuX29uSW5wdXQoKSk7DQogICAgICAgIHZhbElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5fb25JbnB1dCgpKTsNCiAgICAgICAgQmxvY2tseS5Ecm9wRG93bkRpdi5zZXRDb2xvdXIodGhpcy5zb3VyY2VCbG9ja18ucGFyZW50QmxvY2tfLmdldENvbG91cigpLCB0aGlzLnNvdXJjZUJsb2NrXy5wYXJlbnRCbG9ja18uZ2V0Q29sb3VyVGVydGlhcnkoKSk7DQogICAgICAgIEJsb2NrbHkuRHJvcERvd25EaXYuc2V0Q2F0ZWdvcnkodGhpcy5zb3VyY2VCbG9ja18ucGFyZW50QmxvY2tfLmdldENhdGVnb3J5KCkpOw0KICAgICAgICBfbW92ZURyb3Bkb3duLmNhbGwodGhpcywgdHJ1ZSk7DQogICAgICB9DQogICAgfQ0KICAgIGltcGxlbWVudGF0aW9ucy5GaWVsZEhpZGRlblRleHRJbnB1dCA9IGNsYXNzIEZpZWxkSGlkZGVuVGV4dElucHV0IGV4dGVuZHMgQmxvY2tseS5GaWVsZFRleHRJbnB1dCB7DQogICAgICBjb25zdHJ1Y3RvcihvcHRfdmFsdWUpIHsNCiAgICAgICAgb3B0X3ZhbHVlID0gU2NyYXRjaC5Bcmd1bWVudFR5cGUuSElEREVOU1RSSU5HOw0KICAgICAgICBzdXBlcihvcHRfdmFsdWUpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoJ1N0cmluZycpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoU2NyYXRjaC5Bcmd1bWVudFR5cGUuSElEREVOU1RSSU5HKTsNCiAgICAgIH0NCiAgICAgIGluaXQoLi4uaW5pdEFyZ3MpIHsNCiAgICAgICAgQmxvY2tseS5GaWVsZFRleHRJbnB1dC5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMsIC4uLmluaXRBcmdzKTsNCiAgICAgICAgX2Rpc2FibGVSZXBvcnRlcnMuY2FsbCh0aGlzKTsNCiAgICAgICAgdGhpcy50ZXh0Tm9kZV9fID0gdGhpcy5zb3VyY2VCbG9ja18uc3ZnUGF0aF8ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCdnLmJsb2NrbHlFZGl0YWJsZVRleHQgdGV4dCcpOw0KICAgICAgICBpZiAoISF0aGlzLnRleHROb2RlX18pIF9maXhDb2xvdXJzLmNhbGwodGhpcywgdHJ1ZSwgdGhpcy5zb3VyY2VCbG9ja18ucGFyZW50QmxvY2tfLmNvbG91cl8sIHRoaXMuc291cmNlQmxvY2tfLnBhcmVudEJsb2NrXy5jb2xvdXJfKTsNCiAgICAgIH0NCiAgICAgIHNob3dFZGl0b3JfKC4uLnNob3dBcmdzKSB7DQogICAgICAgIGlmICghIXRoaXMudGV4dE5vZGVfXykgX2RlbENzc05hdHRyKHRoaXMudGV4dE5vZGVfXywgJ2ZpbGwnKTsNCiAgICAgICAgQmxvY2tseS5GaWVsZFRleHRJbnB1dC5wcm90b3R5cGUuc2hvd0VkaXRvcl8uY2FsbCh0aGlzLCAuLi5zaG93QXJncyk7DQogICAgICB9DQogICAgfQ0KICAgIGltcGxlbWVudGF0aW9ucy5GaWVsZElubGluZURhdGUgPSBjbGFzcyBGaWVsZElubGluZURhdGUgZXh0ZW5kcyBCbG9ja2x5LkZpZWxkIHsNCiAgICAgIC8vIEZvciBoZWxwIHdpdGggZGF0ZSByZWxhdGVkIHN0dWZmIGxvb2sgYXQgdGhlc2UgYXQgdGhleSBoZWxwZWQgbWUgYWxvdC4NCiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvRWxlbWVudC9pbnB1dC9kYXRlDQogICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84NDcxODUvY29udmVydC1hLXVuaXgtdGltZXN0YW1wLXRvLXRpbWUtaW4tamF2YXNjcmlwdA0KICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNzU1NjU5MS9pcy10aGUtamF2YXNjcmlwdC1kYXRlLW9iamVjdC1hbHdheXMtb25lLWRheS1vZmYNCiAgICAgIGNvbnN0cnVjdG9yKG9wdF92YWx1ZSkgew0KICAgICAgICBvcHRfdmFsdWUgPSBTY3JhdGNoLkFyZ3VtZW50VHlwZS5JTkxJTkVEQVRFOw0KICAgICAgICBzdXBlcihvcHRfdmFsdWUpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoJ051bWJlcicpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoU2NyYXRjaC5Bcmd1bWVudFR5cGUuSU5MSU5FREFURSk7DQogICAgICB9DQogICAgICB1cGRhdGVXaWR0aCgpIHsNCiAgICAgICAgdGhpcy5zaXplXy53aWR0aCA9IDEzNjsNCiAgICAgIH0NCiAgICAgIGluaXQoLi4uaW5pdEFyZ3MpIHsNCiAgICAgICAgQmxvY2tseS5GaWVsZE51bWJlci5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMsIC4uLmluaXRBcmdzKTsNCiAgICAgICAgX2Rpc2FibGVSZXBvcnRlcnMuY2FsbCh0aGlzKTsNCiAgICAgICAgdGhpcy50ZXh0Tm9kZV9fID0gdGhpcy5zb3VyY2VCbG9ja18uc3ZnUGF0aF8ucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCdnLmJsb2NrbHlFZGl0YWJsZVRleHQgdGV4dCcpOw0KICAgICAgICBpZiAoISF0aGlzLnRleHROb2RlX18pIHsNCiAgICAgICAgICB0aGlzLnRleHROb2RlX18uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICBfZml4Q29sb3Vycy5jYWxsKHRoaXMsIGZhbHNlLCB0aGlzLnNvdXJjZUJsb2NrXy5wYXJlbnRCbG9ja18uY29sb3VyXyk7DQogICAgICAgIH0NCiAgICAgICAgY29uc3QgdmFsaWREYXRlRm9ybWF0ID0gKC8oXGR7NH0oXC18XC8pXGR7Mn0oXC18XC8pXGR7Mn0pL2kudGVzdCh0aGlzLmdldFZhbHVlKCkpKTsNCiAgICAgICAgaWYgKCF2YWxpZERhdGVGb3JtYXQpIHRoaXMuc2V0VmFsdWUoJzIwMDEtMDEtMDEnKTsNCiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRoaXMuX2dldERhdGUoKSk7DQogICAgICAgIGNvbnN0IHRzID0gdGhpcy5fZGF0ZUZvcm1hdChkYXRlKTsNCiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0cyk7DQogICAgICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsNCiAgICAgICAgaW5wdXQudHlwZSA9ICdkYXRlJzsNCiAgICAgICAgdGhpcy5fZml4RGF0ZShpbnB1dCk7DQogICAgICAgIGlucHV0LndpZHRoID0gMTM2Ow0KICAgICAgICBpbnB1dC5oZWlnaHQgPSAyMjsNCiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB0aGlzLl9vbklucHV0KCkpOw0KICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB0aGlzLl9vbklucHV0KCkpOw0KICAgICAgICBjb25zdCBkYXRlSG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdmb3JlaWduT2JqZWN0Jyk7DQogICAgICAgIGRhdGVIb2xkZXIuc2V0QXR0cmlidXRlKCd4JywgJzgnKTsNCiAgICAgICAgZGF0ZUhvbGRlci5zZXRBdHRyaWJ1dGUoJ3knLCAnLTAuNScpOw0KICAgICAgICBkYXRlSG9sZGVyLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMTM2Jyk7DQogICAgICAgIGRhdGVIb2xkZXIuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjInKTsNCiAgICAgICAgZGF0ZUhvbGRlci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZSkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKSk7DQogICAgICAgIGlmICh0aGlzLmZpZWxkR3JvdXBfKSB0aGlzLmZpZWxkR3JvdXBfLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCBkYXRlSG9sZGVyKTsNCiAgICAgICAgZGF0ZUhvbGRlci5hcHBlbmRDaGlsZChpbnB1dCk7DQogICAgICAgIHRoaXMuX2RhdGUgPSBpbnB1dDsNCiAgICAgICAgdGhpcy5fZGF0ZUhvbGRlciA9IGRhdGVIb2xkZXI7DQogICAgICAgIHRoaXMucmVuZGVyXygpOw0KICAgICAgfQ0KICAgICAgX29uSW5wdXQoKSB7DQogICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5fZGF0ZS52YWx1ZS50b1N0cmluZygpKTsNCiAgICAgIH0NCiAgICAgIF9nZXREYXRlKCkgew0KICAgICAgICByZXR1cm4gdGhpcy5nZXRWYWx1ZSgpLnJlcGxhY2VBbGwoJy0nLCAnLycpOw0KICAgICAgfQ0KICAgICAgX2RhdGVGb3JtYXQoZGF0ZSkgew0KICAgICAgICByZXR1cm4gYCR7ZGF0ZS5nZXRVVENGdWxsWWVhcigpfS0ke1N0cmluZyhkYXRlLmdldFVUQ01vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpfS0ke1N0cmluZyhkYXRlLmdldFVUQ0RhdGUoKSkucGFkU3RhcnQoMiwgJzAnKX1gOw0KICAgICAgfQ0KICAgICAgX2ZpeERhdGUoX2RhdGUpIHsNCiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRoaXMuX2dldERhdGUoKSk7DQogICAgICAgIGNvbnN0IHRzID0gdGhpcy5fZGF0ZUZvcm1hdChkYXRlKTsNCiAgICAgICAgY29uc3QgbXNVbml4ID0gZGF0ZS5nZXRUaW1lKCk7DQogICAgICAgIF9kYXRlLnZhbHVlQXNOdW1iZXIgPSBtc1VuaXg7DQogICAgICAgIF9kYXRlLnZhbHVlID0gdHM7DQogICAgICB9DQogICAgICBzaG93RWRpdG9yXygpIHsNCiAgICAgICAgLy8gVE9ETzogYWRkIG1pbiBhbmQgbWF4IGRhdGUgYWxvbmcgd2l0aCAic3RlcCINCiAgICAgIH0NCiAgICB9DQoNCiAgICAvLyBpY29ucyBmcm9tOiBodHRwczovL2ZvbnRzLmdvb2dsZS5jb20vaWNvbnMNCiAgICBjb25zdCBfZmlsZUljb25Db2xvciA9IGBzdHlsZT0iZmlsbDojRkZGRkZGO3N0cm9rZTojRkZGRkZGOyIgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlPSIjRkZGRkZGImA7DQogICAgY29uc3Qgc2V0dGluZ3NJY29uID0gYGRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJHtidG9hKGA8c3ZnICR7X2ZpbGVJY29uQ29sb3J9IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiIHdpZHRoPSIyNCI+PHBhdGggZD0ibTM3MC04MC0xNi0xMjhxLTEzLTUtMjQuNS0xMlQzMDctMjM1bC0xMTkgNTBMNzgtMzc1bDEwMy03OHEtMS03LTEtMTMuNXYtMjdxMC02LjUgMS0xMy41TDc4LTU4NWwxMTAtMTkwIDExOSA1MHExMS04IDIzLTE1dDI0LTEybDE2LTEyOGgyMjBsMTYgMTI4cTEzIDUgMjQuNSAxMnQyMi41IDE1bDExOS01MCAxMTAgMTkwLTEwMyA3OHExIDcgMSAxMy41djI3cTAgNi41LTIgMTMuNWwxMDMgNzgtMTEwIDE5MC0xMTgtNTBxLTExIDgtMjMgMTV0LTI0IDEyTDU5MC04MEgzNzBabTcwLTgwaDc5bDE0LTEwNnEzMS04IDU3LjUtMjMuNVQ2MzktMzI3bDk5IDQxIDM5LTY4LTg2LTY1cTUtMTQgNy0yOS41dDItMzEuNXEwLTE2LTItMzEuNXQtNy0yOS41bDg2LTY1LTM5LTY4LTk5IDQycS0yMi0yMy00OC41LTM4LjVUNTMzLTY5NGwtMTMtMTA2aC03OWwtMTQgMTA2cS0zMSA4LTU3LjUgMjMuNVQzMjEtNjMzbC05OS00MS0zOSA2OCA4NiA2NHEtNSAxNS03IDMwdC0yIDMycTAgMTYgMiAzMXQ3IDMwbC04NiA2NSAzOSA2OCA5OS00MnEyMiAyMyA0OC41IDM4LjVUNDI3LTI2NmwxMyAxMDZabTQyLTE4MHE1OCAwIDk5LTQxdDQxLTk5cTAtNTgtNDEtOTl0LTk5LTQxcS01OSAwLTk5LjUgNDFUMzQyLTQ4MHEwIDU4IDQwLjUgOTl0OTkuNSA0MVptLTItMTQwWiIvPjwvc3ZnPmApfWA7DQogICAgY29uc3QgdXBsb2FkSWNvbiA9IGBkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LCR7YnRvYShgPHN2ZyAke19maWxlSWNvbkNvbG9yfSB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIiB3aWR0aD0iMjQiPjxwYXRoIGQ9Ik00NDAtMjAwaDgwdi0xNjdsNjQgNjQgNTYtNTctMTYwLTE2MC0xNjAgMTYwIDU3IDU2IDYzLTYzdjE2N1pNMjQwLTgwcS0zMyAwLTU2LjUtMjMuNVQxNjAtMTYwdi02NDBxMC0zMyAyMy41LTU2LjVUMjQwLTg4MGgzMjBsMjQwIDI0MHY0ODBxMCAzMy0yMy41IDU2LjVUNzIwLTgwSDI0MFptMjgwLTUyMHYtMjAwSDI0MHY2NDBoNDgwdi00NDBINTIwWk0yNDAtODAwdjIwMC0yMDAgNjQwLTY0MFoiLz48L3N2Zz5gKX1gOw0KICAgIGltcGxlbWVudGF0aW9ucy5GaWVsZEZpbGVJbnB1dCA9IGNsYXNzIEZpZWxkRmlsZUlucHV0IGV4dGVuZHMgQmxvY2tseS5GaWVsZCB7DQogICAgICBjb25zdHJ1Y3RvcihvcHRfdmFsdWUpIHsNCiAgICAgICAgb3B0X3ZhbHVlID0gU2NyYXRjaC5Bcmd1bWVudFR5cGUuRklMRTsNCiAgICAgICAgc3VwZXIob3B0X3ZhbHVlKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKCdTdHJpbmcnKTsNCiAgICAgICAgdGhpcy5hZGRBcmdUeXBlKFNjcmF0Y2guQXJndW1lbnRUeXBlLkZJTEUpOw0KICAgICAgfQ0KICAgICAgdXBkYXRlV2lkdGgoKSB7DQogICAgICAgIHRoaXMuc2l6ZV8ud2lkdGggPSA0MDsNCiAgICAgIH0NCiAgICAgIGluaXQoLi4uaW5pdEFyZ3MpIHsNCiAgICAgICAgdGhpcy5fZGVsaW0gPSAnXG4nOw0KICAgICAgICBCbG9ja2x5LkZpZWxkVGV4dElucHV0LnByb3RvdHlwZS5pbml0LmNhbGwodGhpcywgLi4uaW5pdEFyZ3MpOw0KICAgICAgICBfZGlzYWJsZVJlcG9ydGVycy5jYWxsKHRoaXMpOw0KICAgICAgICB0aGlzLnRleHROb2RlX18gPSB0aGlzLnNvdXJjZUJsb2NrXy5zdmdQYXRoXy5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJ2cuYmxvY2tseUVkaXRhYmxlVGV4dCB0ZXh0Jyk7DQogICAgICAgIGlmICghIXRoaXMudGV4dE5vZGVfXykgew0KICAgICAgICAgIHRoaXMudGV4dE5vZGVfXy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgIF9maXhDb2xvdXJzLmNhbGwodGhpcywgZmFsc2UsIHRoaXMuc291cmNlQmxvY2tfLnBhcmVudEJsb2NrXy5jb2xvdXJfKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLl9maWxlRGF0YSA9IG51bGw7DQogICAgICAgIGNvbnN0IGZnXyA9IHRoaXMuZmllbGRHcm91cF87DQogICAgICAgIGlmICghZmdfKSByZXR1cm47DQogICAgICAgIGNvbnN0IHBhdGggPSBmZ18/LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7DQogICAgICAgIGlmIChwYXRoPy5ub2RlTmFtZSAhPT0gJ3BhdGgnKSByZXR1cm47DQogICAgICAgIGNvbnN0IHNldHRpbmdzQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdpbWFnZScpOw0KICAgICAgICBzZXR0aW5nc0J1dHRvbi5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7DQogICAgICAgIHNldHRpbmdzQnV0dG9uLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzI0Jyk7DQogICAgICAgIHNldHRpbmdzQnV0dG9uLnNldEF0dHJpYnV0ZSgneCcsICcxOS41Jyk7DQogICAgICAgIHNldHRpbmdzQnV0dG9uLnNldEF0dHJpYnV0ZSgneScsICctMC41Jyk7DQogICAgICAgIHNldHRpbmdzQnV0dG9uLnNldEF0dHJpYnV0ZSgneGxpbms6aHJlZicsIHNldHRpbmdzSWNvbik7DQogICAgICAgIHNldHRpbmdzQnV0dG9uLnNldEF0dHJpYnV0ZSgnaHJlZicsIHNldHRpbmdzSWNvbik7DQogICAgICAgIHNldHRpbmdzQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB0aGlzLl9vblNldHRpbmdzQ2xpY2soZSkpOw0KICAgICAgICB0aGlzLl9zZXR0aW5nc0J1dHRvbiA9IHNldHRpbmdzQnV0dG9uOw0KICAgICAgICBjb25zdCB1cGxvYWRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2ltYWdlJyk7DQogICAgICAgIHVwbG9hZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7DQogICAgICAgIHVwbG9hZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpOw0KICAgICAgICB1cGxvYWRCdXR0b24uc2V0QXR0cmlidXRlKCd4JywgJy00Jyk7DQogICAgICAgIHVwbG9hZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3knLCAnLTAuNScpOw0KICAgICAgICB1cGxvYWRCdXR0b24uc2V0QXR0cmlidXRlKCd4bGluazpocmVmJywgdXBsb2FkSWNvbik7DQogICAgICAgIHVwbG9hZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCB1cGxvYWRJY29uKTsNCiAgICAgICAgdXBsb2FkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB0aGlzLl9vblVwbG9hZENsaWNrKGUpKTsNCiAgICAgICAgdGhpcy5fdXBsb2FkQnV0dG9uID0gdXBsb2FkQnV0dG9uOw0KICAgICAgICBmZ18uYXBwZW5kQ2hpbGQoc2V0dGluZ3NCdXR0b24pOw0KICAgICAgICBmZ18uYXBwZW5kQ2hpbGQodXBsb2FkQnV0dG9uKTsNCiAgICAgICAgdGhpcy5fc2F2ZUZpbGVEYXRhKCk7DQogICAgICB9DQogICAgICBfbG9hZERhdGEoaXRlbSkgew0KICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0VmFsdWUoKTsNCiAgICAgICAgY29uc3QgY3IxID0gdmFsdWUuaW5kZXhPZih0aGlzLl9kZWxpbSk7DQogICAgICAgIGNvbnN0IGNyMiA9IHZhbHVlLmluZGV4T2YodGhpcy5fZGVsaW0sIGNyMSArIDEpOw0KICAgICAgICBzd2l0Y2ggKGl0ZW0pIHsNCiAgICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICB0aGlzLl9maWxlRGF0YSA9IHZhbHVlLnN1YnN0cihjcjIgKyAxKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgMjoNCiAgICAgICAgICAgIHRoaXMuX291dHB1dE9wdGlvbnMudmFsdWUgPSB2YWx1ZS5zbGljZSgwLCBjcjEpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgY2FzZSAzOg0KICAgICAgICAgICAgdGhpcy5fZmlsZUxpbWl0ZXIudmFsdWUgPSB2YWx1ZS5zbGljZShjcjEgKyAxLCBjcjIpOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICB9DQogICAgICBfc2F2ZUZpbGVEYXRhKHNraXBMb2FkKSB7DQogICAgICAgIGlmICghQm9vbGVhbihza2lwTG9hZCA/PyBmYWxzZSkpIHRoaXMuX2xvYWREYXRhKDEpOw0KICAgICAgICB0aGlzLnNob3dFZGl0b3JfKHRydWUpOw0KICAgICAgICB0aGlzLl9vbklucHV0KHRoaXMuX2ZpbGVEYXRhKTsNCiAgICAgICAgQmxvY2tseS5Ecm9wRG93bkRpdi5oaWRlV2l0aG91dEFuaW1hdGlvbigpOw0KICAgICAgICB0aGlzLl9maWxlRGF0YSA9IG51bGw7DQogICAgICB9DQogICAgICBfb25TZXR0aW5nc0NsaWNrKGUpIHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgdGhpcy5zaG93RWRpdG9yXyh0cnVlKTsNCiAgICAgIH0NCiAgICAgIF9vblVwbG9hZENsaWNrKGUpIHsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgY29uc3QgZmlsZUlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsNCiAgICAgICAgdGhpcy5zaG93RWRpdG9yXyh0cnVlKTsNCiAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7DQogICAgICAgIGZpbGVJbnB1dC5hY2NlcHQgPSB0aGlzLl9maWxlTGltaXRlci52YWx1ZS5yZXBsYWNlQWxsKHRoaXMuX2RlbGltLCAnJykudHJpbSgpIHx8ICcqLionOw0KICAgICAgICBjb25zdCBsb2FkVHlwZSA9IHRoaXMuX291dHB1dE9wdGlvbnMudmFsdWU7DQogICAgICAgIEJsb2NrbHkuRHJvcERvd25EaXYuaGlkZVdpdGhvdXRBbmltYXRpb24oKTsNCiAgICAgICAgY29uc3QgZmlFcnIgPSAoYywgYWxyKSA9PiB7DQogICAgICAgICAgYyA9ICFjOw0KICAgICAgICAgIGlmIChjKSB7DQogICAgICAgICAgICB0aGlzLl91cGxvYWRCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICBmaWxlSW5wdXQucmVtb3ZlKCk7DQogICAgICAgICAgICBhbGVydChhbHIpOw0KICAgICAgICAgIH0NCiAgICAgICAgICByZXR1cm4gYzsNCiAgICAgICAgfQ0KICAgICAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGV2ZW50KSA9PiB7DQogICAgICAgICAgdGhpcy5fdXBsb2FkQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgY29uc3QgZmlsZUxpc3QgPSBldmVudC50YXJnZXQuZmlsZXM7DQogICAgICAgICAgLy8gVGhpcyB3b250IGRvIGFueXRoaW5nIHdoeSA6Y3JpOg0KICAgICAgICAgIGxldCBub0ZpbGVFcnIgPSAoKSA9PiBmYWxzZTsNCiAgICAgICAgICBjb25zdCB1bmZlID0gKCkgPT4gew0KICAgICAgICAgICAgaWYgKGZpbGVMaXN0Lmxlbmd0aCA8IDApIG5vRmlsZUVyciA9ICgpID0+IGZpRXJyKHRydWUsICdObyBmaWxlIHVwbG9hZGVkPycpOw0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgICAgfTsNCiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB1bmZlLCB7b25jZTogdHJ1ZX0pOw0KICAgICAgICAgIGlmICh1bmZlKCkgJiYgbm9GaWxlRXJyKCkpIHJldHVybjsNCiAgICAgICAgICAvLyBPayBkb25lIGNyeWluZy4NCiAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOw0KICAgICAgICAgIHJlYWRlci5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKGV2ZW50KSA9PiB7DQogICAgICAgICAgICB0aGlzLl9maWxlRGF0YSA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7DQogICAgICAgICAgICB0aGlzLl9zYXZlRmlsZURhdGEodHJ1ZSk7DQogICAgICAgICAgICB0aGlzLl91cGxvYWRCdXR0b24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICBmaWxlSW5wdXQucmVtb3ZlKCk7DQogICAgICAgICAgICBhbGVydCgnRmlsZSB1cGxvYWRlZC4nKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgICBjb25zdCBmaWxlID0gZmlsZUxpc3RbMF07DQogICAgICAgICAgaWYgKGZpRXJyKCEhZmlsZSwgJ0ZpbGUgaXMgbnVsbD8hIT8/JykpIHJldHVybjsNCiAgICAgICAgICBzd2l0Y2gobG9hZFR5cGUpIHsNCiAgICAgICAgICAgIGNhc2UgJ2RhdGFVUkwnOg0KICAgICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsNCiAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICBjYXNlICd0ZXh0JzoNCiAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZSk7DQogICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgaWYgKGZpRXJyKGZhbHNlLCAnSW52YWxpZCBvdXRwdXQgb3B0aW9uLicpKSByZXR1cm47DQogICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGZpbGVJbnB1dC5jbGljaygpOw0KICAgICAgfQ0KICAgICAgX2dldEZpbGVEYXRhKCkgew0KICAgICAgICBpZiAoISF0aGlzLl9maWxlRGF0YSkgcmV0dXJuIHRoaXMuX2ZpbGVEYXRhOw0KICAgICAgICB0aGlzLl9sb2FkRGF0YSgxKTsNCiAgICAgICAgY29uc3QgZmlsZURhdGEgPSB0aGlzLl9maWxlRGF0YSA/PyAnJzsNCiAgICAgICAgdGhpcy5fZmlsZURhdGEgPSBudWxsOw0KICAgICAgICByZXR1cm4gZmlsZURhdGE7DQogICAgICB9DQogICAgICBfb25JbnB1dChmaWxlRGF0YSkgew0KICAgICAgICBpZiAodGhpcy5fZmlsZUxpbWl0ZXIudmFsdWUudHJpbSgpLmxlbmd0aCA8IDEpIHRoaXMuX2ZpbGVMaW1pdGVyLnZhbHVlID0gJyouKic7DQogICAgICAgIHRoaXMuc2V0VmFsdWUoYCR7dGhpcy5fb3V0cHV0T3B0aW9ucy52YWx1ZX0ke3RoaXMuX2RlbGltfSR7dGhpcy5fZmlsZUxpbWl0ZXIudmFsdWUucmVwbGFjZUFsbCh0aGlzLl9kZWxpbSwgJycpfSR7dGhpcy5fZGVsaW19JHtmaWxlRGF0YSA/PyB0aGlzLl9nZXRGaWxlRGF0YSgpfWApOw0KICAgICAgfQ0KICAgICAgX29wdERyb3Bkb3duKHNlbGVjdGVkLCAuLi5vcHRWYWx1ZXMpIHsNCiAgICAgICAgb3B0VmFsdWVzID0gKG9wdFZhbHVlcyA/PyBbXSkubWFwKG9wdCA9PiBgPG9wdGlvbiB2YWx1ZT0iJHtvcHR9IiR7c2VsZWN0ZWQ9PT1vcHQgPyAnc2VsZWN0ZWQ9IiInIDogJyd9PiR7b3B0fTwvb3B0aW9uPmApLmpvaW4oJ1xuJyk7DQogICAgICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpOw0KICAgICAgICByZXR1cm4geyBzZWxlY3QsIG9wdFZhbHVlcyB9Ow0KICAgICAgfQ0KICAgICAgc2hvd0VkaXRvcl8oZm9yY2VTaG93KSB7DQogICAgICAgIGlmICghQm9vbGVhbihmb3JjZVNob3cgPz8gZmFsc2UpKSByZXR1cm47DQogICAgICAgIEJsb2NrbHkuRHJvcERvd25EaXYuY2xlYXJDb250ZW50KCk7DQogICAgICAgIGNvbnN0IGRpdiA9IEJsb2NrbHkuRHJvcERvd25EaXYuZ2V0Q29udGVudERpdigpOw0KICAgICAgICBjb25zdCBvdXRwdXRPcHRpb25zX3RlbXAgPSB0aGlzLl9vcHREcm9wZG93bignZGF0YVVSTCcsICdkYXRhVVJMJywgJ3RleHQnKTsNCiAgICAgICAgY29uc3Qgb3V0cHV0T3B0aW9ucyA9IG91dHB1dE9wdGlvbnNfdGVtcC5zZWxlY3Q7DQogICAgICAgIG91dHB1dE9wdGlvbnMuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB0aGlzLl9vbklucHV0KCkpOw0KICAgICAgICBjb25zdCBmaWxlTGltaXRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7DQogICAgICAgIGZpbGVMaW1pdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5fb25JbnB1dCgpKTsNCiAgICAgICAgY29uc3QgY2xlYXJCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsNCiAgICAgICAgaWYgKCEhdGhpcy5fZ2V0RmlsZURhdGEoKS5hdCgwKSkgew0KICAgICAgICAgIGNsZWFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5fZmlsZURhdGEgPSBudWxsOw0KICAgICAgICAgICAgdGhpcy5fb25JbnB1dCgnJyk7DQogICAgICAgICAgICBjbGVhckJ0bi5uZXh0RWxlbWVudFNpYmxpbmcucmVtb3ZlKCk7DQogICAgICAgICAgICBjbGVhckJ0bi5yZW1vdmUoKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoY2xlYXJCdG4pOw0KICAgICAgICAgIGNsZWFyQnRuLnRleHRDb250ZW50ID0gJ0NsZWFyIGZpbGUuJzsNCiAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKSk7DQogICAgICAgIH0NCiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdVcGxvYWQgYXM6ICcpKTsNCiAgICAgICAgZGl2LmFwcGVuZENoaWxkKG91dHB1dE9wdGlvbnMpOw0KICAgICAgICBvdXRwdXRPcHRpb25zLmlubmVySFRNTCA9IG91dHB1dE9wdGlvbnNfdGVtcC5vcHRWYWx1ZXM7DQogICAgICAgIGRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKTsNCiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCdMaW1pdCBmaWxlIHR5cGVzOiAnKSk7DQogICAgICAgIGRpdi5hcHBlbmRDaGlsZChmaWxlTGltaXRlcik7DQogICAgICAgIGRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdicicpKTsNCiAgICAgICAgdGhpcy5fb3V0cHV0T3B0aW9ucyA9IG91dHB1dE9wdGlvbnM7DQogICAgICAgIHRoaXMuX2ZpbGVMaW1pdGVyID0gZmlsZUxpbWl0ZXI7DQogICAgICAgIEJsb2NrbHkuRHJvcERvd25EaXYuc2V0Q29sb3VyKHRoaXMuc291cmNlQmxvY2tfLnBhcmVudEJsb2NrXy5nZXRDb2xvdXIoKSwgdGhpcy5zb3VyY2VCbG9ja18ucGFyZW50QmxvY2tfLmdldENvbG91clRlcnRpYXJ5KCkpOw0KICAgICAgICBCbG9ja2x5LkRyb3BEb3duRGl2LnNldENhdGVnb3J5KHRoaXMuc291cmNlQmxvY2tfLnBhcmVudEJsb2NrXy5nZXRDYXRlZ29yeSgpKTsNCiAgICAgICAgX21vdmVEcm9wZG93bi5jYWxsKHRoaXMsIHRydWUpOw0KICAgICAgICB0aGlzLl9sb2FkRGF0YSgyKTsNCiAgICAgICAgdGhpcy5fbG9hZERhdGEoMyk7DQogICAgICB9DQogICAgfQ0KDQogICAgaW1wbGVtZW50YXRpb25zLkZpZWxkSW5saW5lRG9vbSA9IGNsYXNzIEZpZWxkSW5saW5lRG9vbSBleHRlbmRzIEJsb2NrbHkuRmllbGQgew0KICAgICAgc2hvd0VkaXRvcl8oKSB7DQogICAgICB9DQogICAgICBjb25zdHJ1Y3RvcihvcHRfdmFsdWUpIHsNCiAgICAgICAgb3B0X3ZhbHVlID0gJ0lubGluZURvb20nOw0KICAgICAgICBzdXBlcihvcHRfdmFsdWUpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoJ1N0cmluZycpOw0KICAgICAgICB0aGlzLmFkZEFyZ1R5cGUoJ0lubGluZURvb20nKTsNCiAgICAgIH0NCiAgICAgIHVwZGF0ZVdpZHRoKCkgew0KICAgICAgICB0aGlzLnNpemVfLndpZHRoID0gNjUwOw0KICAgICAgICB0aGlzLnNpemVfLmhlaWdodCA9IDQxMDsNCiAgICAgIH0NCiAgICAgIGluaXQoLi4uaW5pdEFyZ3MpIHsNCiAgICAgICAgdGhpcy5pbmxpbmVEYmxSZW5kZXIgPSB0cnVlOw0KICAgICAgICBCbG9ja2x5LkZpZWxkLnByb3RvdHlwZS5pbml0LmNhbGwodGhpcywgLi4uaW5pdEFyZ3MpOw0KICAgICAgICBfZGlzYWJsZVJlcG9ydGVycy5jYWxsKHRoaXMpOw0KICAgICAgICB0aGlzLnRleHROb2RlX18gPSB0aGlzLnNvdXJjZUJsb2NrXy5zdmdQYXRoXy5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJ2cuYmxvY2tseUVkaXRhYmxlVGV4dCB0ZXh0Jyk7DQogICAgICAgIGlmICghIXRoaXMudGV4dE5vZGVfXykgew0KICAgICAgICAgIHRoaXMudGV4dE5vZGVfXy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgIF9maXhDb2xvdXJzLmNhbGwodGhpcywgZmFsc2UsIHRoaXMuc291cmNlQmxvY2tfLnBhcmVudEJsb2NrXy5jb2xvdXJfKTsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBmZ18gPSB0aGlzLmZpZWxkR3JvdXBfOw0KICAgICAgICBpZiAoIWZnXykgcmV0dXJuOw0KICAgICAgICBjb25zdCBwYXRoID0gZmdfPy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nOw0KICAgICAgICBpZiAocGF0aD8ubm9kZU5hbWUgIT09ICdwYXRoJykgcmV0dXJuOw0KICAgICAgICBjb25zdCBmT2JqID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdmb3JlaWduT2JqZWN0Jyk7DQogICAgICAgIGZPYmouc2V0QXR0cmlidXRlKCd3aWR0aCcsICc2NTAnKTsNCiAgICAgICAgZk9iai5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICc0MTAnKTsNCiAgICAgICAgZk9iai5zZXRBdHRyaWJ1dGUoJ3gnLCAnMCcpOw0KICAgICAgICBmT2JqLnNldEF0dHJpYnV0ZSgneScsICcwJyk7DQogICAgICAgIHRoaXMuX2ZPYmogPSBmT2JqOw0KICAgICAgICB0aGlzLmZnXyA9IGZnXzsNCiAgICAgICAgaWYgKHRoaXMuZmllbGRHcm91cF8pIHRoaXMuZmllbGRHcm91cF8uaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsIGZPYmopOw0KICAgICAgICB0aGlzLl9hZGRET09NKCk7DQogICAgICB9DQogICAgICBfYWRkRE9PTSgpIHsNCiAgICAgICAgbGV0IGZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7DQogICAgICAgIGZyYW1lLndpZHRoID0gNjQwOw0KICAgICAgICBmcmFtZS5oZWlnaHQgPSA0MDA7DQogICAgICAgIGZyYW1lLmlkID0gJ0RPT00nOw0KICAgICAgICB0aGlzLl9mT2JqLmFwcGVuZENoaWxkKGZyYW1lKTsNCiAgICAgICAgLyoqDQogICAgICAgICAgKiANCiAgICAgICAgICAqIE9SSUdJTkFMOiBodHRwczovL2RpZWttYW5uLmdpdGh1Yi5pby93YXNtLWZpenpidXp6L2Rvb20vDQogICAgICAgICAgKiBQb3J0ZWQgZm9yIHVzZSBpbiB0dXJib3dhcnAgYmxvY2tzDQogICAgICAgICAgKiANCiAgICAgICAgICAqLw0KICAgICAgICBmcmFtZS5zcmNkb2MgPSBhdG9iKGBQQ0V0TFNCUFVrbEhTVTVCVERvZ2FIUjBjSE02THk5a2FXVnJiV0Z1Ymk1bmFYUm9kV0l1YVc4dmQyRnpiUzFtYVhwNlluVjZlaTlrYjI5dEx5QXRMVDQ4SVdSdlkzUjVjR1ZvZEcxc1BqeG9kRzFzUGp4aWIyUjVQanhFVDA5TlBqeHpkSGxzWlQ0amIzVjBjSFYwZTJKdmNtUmxjam96Y0hnZ1ozSnZiM1psSUNNM1ptWm1aRFE3WW1GamEyZHliM1Z1WkMxamIyeHZjanBpYVhOeGRXVTdkMmxrZEdnNk5UVXdjSGc3YUdWcFoyaDBPalF3TUhCNE8yWnZiblF0Wm1GdGFXeDVPbTF2Ym05emNHRmpaU3h6WlhKcFpqdG1iMjUwTFhOcGVtVTZNVEJ3ZUR0dmRtVnlabXh2ZHkxNU9uTmpjbTlzYkgwamIzVjBjSFYwSUhOd1lXNHViRzluZTJOdmJHOXlPaU0wT0ROa09HSjlJMjkxZEhCMWRDQnpjR0Z1TG5OMFpHOTFkSHRqYjJ4dmNqb2pNREF3ZlNOdmRYUndkWFFnYzNCaGJpNXpkR1JsY25KN1ptOXVkQzEzWldsbmFIUTZOekF3TzJOdmJHOXlPbUp5YjNkdWZTNWpiMjUwWVdsdVpYSjdaR2x6Y0d4aGVUcG1iR1Y0ZlNwN2JXRnlaMmx1T2pCd2VEdHdZV1JrYVc1bk9qQndlSDA4TDNOMGVXeGxQanh6Y0dGdUlHaHBaR1JsYmo0OGNDQnBaRDFtYjJOMWMyaHBiblErUEM5d1BqeHdQanhpZFhSMGIyNGdhV1E5Wlc1MFpYSkNkWFIwYjI0K1BDOWlkWFIwYjI0K1BHSjFkSFJ2YmlCcFpEMXNaV1owUW5WMGRHOXVQand2WW5WMGRHOXVQanhpZFhSMGIyNGdhV1E5ZFhCQ2RYUjBiMjQrUEM5aWRYUjBiMjQrUEdKMWRIUnZiaUJwWkQxa2IzZHVRblYwZEc5dVBqd3ZZblYwZEc5dVBqeGlkWFIwYjI0Z2FXUTljbWxuYUhSQ2RYUjBiMjQrUEM5aWRYUjBiMjQrSUR4aWRYUjBiMjRnYVdROVkzUnliRUoxZEhSdmJqNDhMMkoxZEhSdmJqNDhZblYwZEc5dUlHbGtQWE53WVdObFFuVjBkRzl1UGp3dlluVjBkRzl1UGlBOFluVjBkRzl1SUdsa1BXRnNkRUoxZEhSdmJqNDhMMkoxZEhSdmJqNDhMM0ErUEM5emNHRnVQanhrYVhZZ1kyeGhjM005WTI5dWRHRnBibVZ5UGp4allXNTJZWE1nYUdWcFoyaDBQVFF3TUNCcFpEMXpZM0psWlc0Z2RHRmlhVzVrWlhnOU1DQjNhV1IwYUQwMk5EQStWR2hwY3lCcGN5QjNhR1Z5WlNCMGFHVWdSRzl2VFNCelkzSmxaVzRnYzJodmRXeGtJSEpsYm1SbGNpNDhMMk5oYm5aaGN6NDhaR2wySUdocFpHUmxiaUJwWkQxdmRYUndkWFErUEM5a2FYWStQQzlrYVhZK1BITndZVzRnYUdsa1pHVnVQanh6Y0dGdUlHbGtQV2RsZEcxemNITmZjM1JoZEhNK1BDOXpjR0Z1UGp4emNHRnVJR2xrUFdkbGRHMXpYM04wWVhSelBqd3ZjM0JoYmo0Z1BITndZVzRnYVdROVpuQnpYM04wWVhSelBqd3ZjM0JoYmo0OGMzQmhiaUJwWkQxa2NtRjNabkpoYldWelgzTjBZWFJ6UGp3dmMzQmhiajRnUEhOd1lXNGdhV1E5WVc1cGJXRjBhVzl1Wm5CelgzTjBZWFJ6UGp3dmMzQmhiajQ4TDNOd1lXNCtQSE5qY21sd2RDQmtaV1psY2o0aWRYTmxJSE4wY21samRDSTdkbUZ5SUcxbGJXOXllVDF1WlhjZ1YyVmlRWE56WlcxaWJIa3VUV1Z0YjNKNUtIdHBibWwwYVdGc09qRXdPSDBwTzJOdmJuTjBJRzkxZEhCMWREMWtiMk4xYldWdWRDNW5aWFJGYkdWdFpXNTBRbmxKWkNnaWIzVjBjSFYwSWlrN1puVnVZM1JwYjI0Z2NtVmhaRmRoYzIxVGRISnBibWNvZEN4bEtYdHNaWFFnYmoxdVpYY2dWV2x1ZERoQmNuSmhlU2h0WlcxdmNua3VZblZtWm1WeUxIUXNaU2s3Y21WMGRYSnVJRzVsZHlCVVpYaDBSR1ZqYjJSbGNpZ2lkWFJtT0NJcExtUmxZMjlrWlNodUtYMW1kVzVqZEdsdmJpQmpiMjV6YjJ4bFRHOW5VM1J5YVc1bktIUXNaU2w3YkdWMElHNDljbVZoWkZkaGMyMVRkSEpwYm1jb2RDeGxLVHRqYjI1emIyeGxMbXh2WnlnbklpY3JiaXNuSWljcGZXWjFibU4wYVc5dUlHRndjR1Z1WkU5MWRIQjFkQ2gwS1h0eVpYUjFjbTRnWm5WdVkzUnBiMjRvWlN4dUtYdHNaWFFnY3oxeVpXRmtWMkZ6YlZOMGNtbHVaeWhsTEc0cExuTndiR2wwS0NKY2JpSXBPMlp2Y2loMllYSWdZVDB3TzJFOGN5NXNaVzVuZEdnN0t5dGhLV2xtS0RBaFBYTmJZVjB1YkdWdVozUm9LWHQyWVhJZ2NqMWtiMk4xYldWdWRDNWpjbVZoZEdWRmJHVnRaVzUwS0NKemNHRnVJaWs3Y2k1amJHRnpjMHhwYzNRdVlXUmtLSFFwTEhJdVlYQndaVzVrUTJocGJHUW9aRzlqZFcxbGJuUXVZM0psWVhSbFZHVjRkRTV2WkdVb2MxdGhYU2twTEc5MWRIQjFkQzVoY0hCbGJtUkRhR2xzWkNoeUtTeHZkWFJ3ZFhRdVlYQndaVzVrUTJocGJHUW9aRzlqZFcxbGJuUXVZM0psWVhSbFJXeGxiV1Z1ZENnaVluSWlLU2tzY2k1elkzSnZiR3hKYm5SdlZtbGxkeWg3WW1Wb1lYWnBiM0k2SW5OdGIyOTBhQ0lzWW14dlkyczZJbVZ1WkNJc2FXNXNhVzVsT2lKdVpXRnlaWE4wSW4wcGZYMTlZMjl1YzNRZ1oyVjBiWE53YzE5emRHRjBjejFrYjJOMWJXVnVkQzVuWlhSRmJHVnRaVzUwUW5sSlpDZ2laMlYwYlhOd2MxOXpkR0YwY3lJcExHZGxkRzF6WDNOMFlYUnpQV1J2WTNWdFpXNTBMbWRsZEVWc1pXMWxiblJDZVVsa0tDSm5aWFJ0YzE5emRHRjBjeUlwTzNaaGNpQm5aWFJ0YzE5allXeHNjMTkwYjNSaGJEMHdMR2RsZEcxelgyTmhiR3h6UFRBN1puVnVZM1JwYjI0Z1oyVjBUV2xzYkdselpXTnZibVJ6S0NsN2NtVjBkWEp1S3l0blpYUnRjMTlqWVd4c2N5eHdaWEptYjNKdFlXNWpaUzV1YjNjb0tYMTNhVzVrYjNjdWMyVjBTVzUwWlhKMllXd29ablZ1WTNScGIyNG9LWHRuWlhSdGMxOWpZV3hzYzE5MGIzUmhiQ3M5WjJWMGJYTmZZMkZzYkhNc1oyVjBiWE53YzE5emRHRjBjeTVwYm01bGNsUmxlSFE5WjJWMGJYTmZZMkZzYkhNdk1XVXpLeUpySWl4blpYUnRjMTl6ZEdGMGN5NXBibTVsY2xSbGVIUTlaMlYwYlhOZlkyRnNiSE5mZEc5MFlXd3NaMlYwYlhOZlkyRnNiSE05TUgwc01XVXpLVHRqYjI1emRDQmpZVzUyWVhNOVpHOWpkVzFsYm5RdVoyVjBSV3hsYldWdWRFSjVTV1FvSW5OamNtVmxiaUlwTEdSdmIyMWZjMk55WldWdVgzZHBaSFJvUFRZME1DeGtiMjl0WDNOamNtVmxibDlvWldsbmFIUTlOREF3TEdad2MxOXpkR0YwY3oxa2IyTjFiV1Z1ZEM1blpYUkZiR1Z0Wlc1MFFubEpaQ2dpWm5CelgzTjBZWFJ6SWlrc1pISmhkMlp5WVcxbGMxOXpkR0YwY3oxa2IyTjFiV1Z1ZEM1blpYUkZiR1Z0Wlc1MFFubEpaQ2dpWkhKaGQyWnlZVzFsYzE5emRHRjBjeUlwTzNaaGNpQnVkVzFpWlhKZmIyWmZaSEpoZDNOZmRHOTBZV3c5TUN4dWRXMWlaWEpmYjJaZlpISmhkM005TUR0bWRXNWpkR2x2YmlCa2NtRjNRMkZ1ZG1GektIUXBlM1poY2lCbFBXNWxkeUJWYVc1ME9FTnNZVzF3WldSQmNuSmhlU2h0WlcxdmNua3VZblZtWm1WeUxIUXNNVEF5TkdVektTeHVQVzVsZHlCSmJXRm5aVVJoZEdFb1pTdzJOREFzTkRBd0tUdGpZVzUyWVhNdVoyVjBRMjl1ZEdWNGRDZ2lNbVFpS1M1d2RYUkpiV0ZuWlVSaGRHRW9iaXd3TERBcExDc3JiblZ0WW1WeVgyOW1YMlJ5WVhkemZYZHBibVJ2ZHk1elpYUkpiblJsY25aaGJDaG1kVzVqZEdsdmJpZ3BlMjUxYldKbGNsOXZabDlrY21GM2MxOTBiM1JoYkNzOWJuVnRZbVZ5WDI5bVgyUnlZWGR6TEdSeVlYZG1jbUZ0WlhOZmMzUmhkSE11YVc1dVpYSlVaWGgwUFc1MWJXSmxjbDl2Wmw5a2NtRjNjMTkwYjNSaGJDeG1jSE5mYzNSaGRITXVhVzV1WlhKVVpYaDBQVzUxYldKbGNsOXZabDlrY21GM2N5eHVkVzFpWlhKZmIyWmZaSEpoZDNNOU1IMHNNV1V6S1R0MllYSWdhVzF3YjNKMFQySnFaV04wUFh0cWN6cDdhbk5mWTI5dWMyOXNaVjlzYjJjNllYQndaVzVrVDNWMGNIVjBLQ0pzYjJjaUtTeHFjMTl6ZEdSdmRYUTZZWEJ3Wlc1a1QzVjBjSFYwS0NKemRHUnZkWFFpS1N4cWMxOXpkR1JsY25JNllYQndaVzVrVDNWMGNIVjBLQ0p6ZEdSbGNuSWlLU3hxYzE5dGFXeHNhWE5sWTI5dVpITmZjMmx1WTJWZmMzUmhjblE2WjJWMFRXbHNiR2x6WldOdmJtUnpMR3B6WDJSeVlYZGZjMk55WldWdU9tUnlZWGREWVc1MllYTjlMR1Z1ZGpwN2JXVnRiM0o1T20xbGJXOXllWDE5TzFkbFlrRnpjMlZ0WW14NUxtbHVjM1JoYm5ScFlYUmxVM1J5WldGdGFXNW5LR1psZEdOb0tDSm9kSFJ3Y3pvdkwzTjFjbll1YVhNdFlTNWtaWFl2Wkc5dmJTNTNZWE50SWlrc2FXMXdiM0owVDJKcVpXTjBLUzUwYUdWdUtIUTlQbnQwTG1sdWMzUmhibU5sTG1WNGNHOXlkSE11YldGcGJpZ3BPMnhsZENCbFBXWjFibU4wYVc5dUtIUXBlM04zYVhSamFDaDBLWHRqWVhObElEZzZjbVYwZFhKdUlERXlOenRqWVhObElERTNPbkpsZEhWeWJpQXhOVGM3WTJGelpTQXhPRHB5WlhSMWNtNGdNVGcwTzJOaGMyVWdNemM2Y21WMGRYSnVJREUzTWp0allYTmxJRE00T25KbGRIVnliaUF4TnpNN1kyRnpaU0F6T1RweVpYUjFjbTRnTVRjME8yTmhjMlVnTkRBNmNtVjBkWEp1SURFM05UdGtaV1poZFd4ME9tbG1LSFErUFRZMUppWjBQRDA1TUNseVpYUjFjbTRnZENzek1qdHBaaWgwUGoweE1USW1KblE4UFRFeU15bHlaWFIxY200Z2RDczNOVHR5WlhSMWNtNGdkSDE5TEc0OVpuVnVZM1JwYjI0b1pTbDdkQzVwYm5OMFlXNWpaUzVsZUhCdmNuUnpMbUZrWkY5aWNtOTNjMlZ5WDJWMlpXNTBLREFzWlNsOUxITTlablZ1WTNScGIyNG9aU2w3ZEM1cGJuTjBZVzVqWlM1bGVIQnZjblJ6TG1Ga1pGOWljbTkzYzJWeVgyVjJaVzUwS0RFc1pTbDlPMk5oYm5aaGN5NWhaR1JGZG1WdWRFeHBjM1JsYm1WeUtDSnJaWGxrYjNkdUlpeG1kVzVqZEdsdmJpaDBLWHR1S0dVb2RDNXJaWGxEYjJSbEtTa3NkQzV3Y21WMlpXNTBSR1ZtWVhWc2RDZ3BmU3doTVNrc1kyRnVkbUZ6TG1Ga1pFVjJaVzUwVEdsemRHVnVaWElvSW10bGVYVndJaXhtZFc1amRHbHZiaWgwS1h0ektHVW9kQzVyWlhsRGIyUmxLU2tzZEM1d2NtVjJaVzUwUkdWbVlYVnNkQ2dwZlN3aE1Ta3NXMXNpWlc1MFpYSkNkWFIwYjI0aUxERXpYU3hiSW14bFpuUkNkWFIwYjI0aUxERTNNbDBzV3lKeWFXZG9kRUoxZEhSdmJpSXNNVGMwWFN4YkluVndRblYwZEc5dUlpd3hOek5kTEZzaVpHOTNia0oxZEhSdmJpSXNNVGMxWFN4YkltTjBjbXhDZFhSMGIyNGlMREUxTjEwc1d5SnpjR0ZqWlVKMWRIUnZiaUlzTXpKZExGc2lZV3gwUW5WMGRHOXVJaXd4T0RSZFhTNW1iM0pGWVdOb0tDaGJkQ3hsWFNrOVBudGpiMjV6YjJ4bExteHZaeWgwS3lJZ1ptOXlJQ0lyWlNrN2RtRnlJR0U5Wkc5amRXMWxiblF1WjJWMFJXeGxiV1Z1ZEVKNVNXUW9kQ2s3WVM1aFpHUkZkbVZ1ZEV4cGMzUmxibVZ5S0NKMGIzVmphSE4wWVhKMElpd29LVDArYmlobEtTa3NZUzVoWkdSRmRtVnVkRXhwYzNSbGJtVnlLQ0owYjNWamFHVnVaQ0lzS0NrOVBuTW9aU2twTEdFdVlXUmtSWFpsYm5STWFYTjBaVzVsY2lnaWRHOTFZMmhqWVc1alpXd2lMQ2dwUFQ1ektHVXBLWDBwTzJ4bGRDQmhQV1J2WTNWdFpXNTBMbWRsZEVWc1pXMWxiblJDZVVsa0tDSm1iMk4xYzJocGJuUWlLU3h5UFdaMWJtTjBhVzl1S0hRcGUyRXVhVzV1WlhKVVpYaDBQU0pMWlhsaWIyRnlaQ0JsZG1WdWRITWdkMmxzYkNCaVpTQmpZWEIwZFhKbFpDQmhjeUJzYjI1bklHRnpJSFJvWlNCMGFHVWdSRTlQVFNCallXNTJZWE1nYUdGeklHWnZZM1Z6TGlJc1lTNXpkSGxzWlM1bWIyNTBWMlZwWjJoMFBTSnViM0p0WVd3aWZUdGpZVzUyWVhNdVlXUmtSWFpsYm5STWFYTjBaVzVsY2lnaVptOWpkWE5wYmlJc2Npd2hNU2tzWTJGdWRtRnpMbUZrWkVWMlpXNTBUR2x6ZEdWdVpYSW9JbVp2WTNWemIzVjBJaXhtZFc1amRHbHZiaWgwS1h0aExtbHVibVZ5VkdWNGREMGlRMnhwWTJzZ2IyNGdkR2hsSUdOaGJuWmhjeUIwYnlCallYQjFkR1VnYVc1d2RYUWdZVzVrSUhOMFlYSjBJSEJzWVhscGJtY3VJaXhoTG5OMGVXeGxMbVp2Ym5SWFpXbG5hSFE5SW1KdmJHUWlmU3doTVNrc1kyRnVkbUZ6TG1adlkzVnpLQ2tzY2lncE8yeGxkQ0J2UFdSdlkzVnRaVzUwTG1kbGRFVnNaVzFsYm5SQ2VVbGtLQ0poYm1sdFlYUnBiMjVtY0hOZmMzUmhkSE1pS1R0MllYSWdkVDB3TzJaMWJtTjBhVzl1SUdNb1pTbDdLeXQxTEhRdWFXNXpkR0Z1WTJVdVpYaHdiM0owY3k1a2IyOXRYMnh2YjNCZmMzUmxjQ2dwTEhkcGJtUnZkeTV5WlhGMVpYTjBRVzVwYldGMGFXOXVSbkpoYldVb1l5bDlkMmx1Wkc5M0xuTmxkRWx1ZEdWeWRtRnNLR1oxYm1OMGFXOXVLQ2w3Ynk1cGJtNWxjbFJsZUhROWRTeDFQVEI5TERGbE15a3NkMmx1Wkc5M0xuSmxjWFZsYzNSQmJtbHRZWFJwYjI1R2NtRnRaU2hqS1gwcE96d3ZjMk55YVhCMFBqd3ZSRTlQVFQ0OEwySnZaSGsrUEM5b2RHMXNQZz09YCk7DQogICAgICB9DQogICAgfQ0KDQogICAgd2hpbGUgKHRvUmVnaXN0ZXJPbkJsb2NrbHlHb3QubGVuZ3RoID4gMCkgew0KICAgICAgY29uc3QgW25hbWUsIGltcGxdID0gdG9SZWdpc3Rlck9uQmxvY2tseUdvdC5zaGlmdCgpOw0KICAgICAgQmxvY2tseS5GaWVsZC5yZWdpc3RlcihuYW1lLCBpbXBsKTsNCiAgICB9DQoNCiAgICAvLyBBdHRlbXB0IHRvIHJlbG9hZCB0aGUgd29ya3NwYWNlIGFuZCB3aGF0IG5vdC4NCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vVHVyYm9XYXJwL2FkZG9ucy9ibG9iL3R3L2FkZG9ucy9jdXN0b20tYmxvY2stc2hhcGUvdXBkYXRlLWFsbC1ibG9ja3MuanMNCiAgICBjb25zdCBldmVudHNPcmlnaW5hbGx5RW5hYmxlZCA9IEJsb2NrbHkuRXZlbnRzLmlzRW5hYmxlZCgpLCB3b3Jrc3BhY2UgPSBCbG9ja2x5LmdldE1haW5Xb3Jrc3BhY2UoKTsNCiAgICBCbG9ja2x5LkV2ZW50cy5kaXNhYmxlKCk7DQogICAgaWYgKHdvcmtzcGFjZSkgew0KICAgICAgaWYgKHZtLmVkaXRpbmdUYXJnZXQpIHsNCiAgICAgICAgdm0uZW1pdFdvcmtzcGFjZVVwZGF0ZSgpOw0KICAgICAgfQ0KICAgICAgY29uc3QgZmx5b3V0ID0gd29ya3NwYWNlLmdldEZseW91dCgpOw0KICAgICAgaWYgKGZseW91dCkgew0KICAgICAgICBjb25zdCBmbHlvdXRXb3Jrc3BhY2UgPSBmbHlvdXQuZ2V0V29ya3NwYWNlKCk7DQogICAgICAgIEJsb2NrbHkuWG1sLmNsZWFyV29ya3NwYWNlQW5kTG9hZEZyb21YbWwoDQogICAgICAgICAgQmxvY2tseS5YbWwud29ya3NwYWNlVG9Eb20oZmx5b3V0V29ya3NwYWNlKSwNCiAgICAgICAgICBmbHlvdXRXb3Jrc3BhY2UNCiAgICAgICAgKTsNCiAgICAgICAgd29ya3NwYWNlLmdldFRvb2xib3goKS5yZWZyZXNoU2VsZWN0aW9uKCk7DQogICAgICAgIHdvcmtzcGFjZS50b29sYm94UmVmcmVzaEVuYWJsZWRfID0gdHJ1ZTsNCiAgICAgIH0NCiAgICB9DQogICAgaWYgKGV2ZW50c09yaWdpbmFsbHlFbmFibGVkKSBCbG9ja2x5LkV2ZW50cy5lbmFibGUoKTsNCg0KICAgIC8vIEV4cG9zaW5nIGZpZWxkcw0KICAgIC8vIFRoaXMgZG9lcyBub3QgYWZmZWN0IGFueXRoaW5nIGl0cyBqdXN0IG1lIGRvaW5nIGRlYnVnZ2luZyBzdHVmZi4NCiAgICAvLyBCbG9ja2x5LkZpZWxkVGV4dGFyZWEgPSBGaWVsZFRleHRhcmVhOw0KICAgIC8vIEJsb2NrbHkuRmllbGRTbmFwQm9vbGVhbiA9IEZpZWxkU25hcEJvb2xlYW47DQogICAgLy8gQmxvY2tseS5GaWVsZEhpZGRlblRleHRJbnB1dCA9IEZpZWxkSGlkZGVuVGV4dElucHV0Ow0KICAgIC8vIEJsb2NrbHkuRmllbGRJbmxpbmVTbGlkZXIgPSBGaWVsZElubGluZVNsaWRlcjsNCiAgICAvLyBCbG9ja2x5LkZpZWxkSW5saW5lRGF0ZSA9IEZpZWxkSW5saW5lRGF0ZTsNCiAgICAvLyBCbG9ja2x5LkZpZWxkRmlsZUlucHV0ID0gRmllbGRGaWxlSW5wdXQ7DQogICAgLy8gU2tpcCBET09NIGNhdXNlIGl0cyBteSBmdW5ueSBmaWVsZC4NCiAgfQ0KDQogIC8vIFBhc3NlcyAiQmxvY2tseSIgdG8gdHJ5VXNlU2NyYXRjaEJsb2NrcyBpZiBTY3JhdGNoLmd1aSBpcyBhIG9iamVjdC4NCiAgaWYgKHR5cGVvZiBTY3JhdGNoPy5ndWkgPT09ICdvYmplY3QnKSBTY3JhdGNoLmd1aS5nZXRCbG9ja2x5KCkudGhlbigoQmxvY2tseSkgPT4gdHJ5VXNlU2NyYXRjaEJsb2NrcyhCbG9ja2x5KSk7DQoNCiAgLy8gQWN0dWFsICJleHRlbnNpb24iIHBhcnQNCiAgY2xhc3MgZXh0ZW5zaW9uIHsNCiAgICBjb25zdHJ1Y3RvcigpIHt9DQogICAgZ2V0SW5mbygpIHsNCiAgICAgIGNvbnN0IGdldEluZm8gPSAoew0KICAgICAgICBpZDogJzB6bnp3TW9yZUZpZWxkcycsDQogICAgICAgIG5hbWU6ICdNb3JlIEZpZWxkcycsDQogICAgICAgIGNvbG9yMTogJyM5NTY2ZDMnLA0KICAgICAgICBjb2xvcjI6ICcjOTU2NmQzJywNCiAgICAgICAgY29sb3IzOiAnIzk1NjZkMycsDQogICAgICAgIGNvbG9yNDogJyM5NTY2ZDMnLA0KICAgICAgICBibG9ja3M6IFsNCiAgICAgICAgICB7DQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IHRydWUsDQogICAgICAgICAgICBvcGNvZGU6ICdtdWx0aWZpZWxkVGVzdCcsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLA0KICAgICAgICAgICAgdGV4dDogJ2ZpbGUgW0ZJTEVdIHNuYXAgYm9vbCBbQk9PTF0gc2xpZGVyIFtOVU1dJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBGSUxFOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuRklMRSwNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdkYXRhVVJMXG4qLypcbicsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIEJPT0w6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TTkFQQk9PTEVBTiwNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IDAsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgIE5VTTogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLklOTElORVNMSURFUiwNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICcxMCwwLDIwJywNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBvcGNvZGU6ICd0ZXh0YXJlYScsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLA0KICAgICAgICAgICAgdGV4dDogJ3RleHRhcmVhIFtURVhUXScsDQogICAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgICAgVEVYVDogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlRFWFRBUkVBLA0KICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJzpEJywNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6IGhpZGVJbmxpbmVUZXh0YXJlYSwNCiAgICAgICAgICAgIG9wY29kZTogJ3RleHRhcmVhSW5saW5lJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsDQogICAgICAgICAgICB0ZXh0OiAndGV4dGFyZWEgW1RFWFRdJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBURVhUOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuSU5MSU5FVEVYVEFSRUEsDQogICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnOkQnLA0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIGhpZGVGcm9tUGFsZXR0ZTogaGlkZUlubGluZVRleHRhcmVhLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5YTUwsDQogICAgICAgICAgICB4bWw6ICc8c2VwIGdhcD0iMTYiLz4nLA0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgb3Bjb2RlOiAnc25hcEJvb2wnLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CT09MRUFOLA0KICAgICAgICAgICAgdGV4dDogJ1tCT09MXScsDQogICAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgICAgQk9PTDogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNOQVBCT09MRUFOLA0KICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogMCwNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBvcGNvZGU6ICdzbGlkZXJJbmxpbmUnLA0KICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwNCiAgICAgICAgICAgIHRleHQ6ICdzbGlkZXI6IFtOVU1dJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBOVU06IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5JTkxJTkVTTElERVIsDQogICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnMTAsMCwyMCcsDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9LA0KICAgICAgICAgIHsNCiAgICAgICAgICAgIG9wY29kZTogJ2hpZGRlblN0cmluZycsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLA0KICAgICAgICAgICAgdGV4dDogJyJzZWNyZXQiIFtURVhUXScsDQogICAgICAgICAgICBhcmd1bWVudHM6IHsNCiAgICAgICAgICAgICAgVEVYVDogew0KICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLkhJRERFTlNUUklORywNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICdvbyBhIHNlY3JldCA7KScsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgIH0sDQogICAgICAgICAgew0KICAgICAgICAgICAgb3Bjb2RlOiAnZGF0ZScsDQogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLA0KICAgICAgICAgICAgdGV4dDogJ2RhdGUgW0RBVEVdJywNCiAgICAgICAgICAgIGFyZ3VtZW50czogew0KICAgICAgICAgICAgICBEQVRFOiB7DQogICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuSU5MSU5FREFURSwNCiAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICcyMDI0LTAzLTE0JywNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBvcGNvZGU6ICdmaWxlJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsDQogICAgICAgICAgICB0ZXh0OiAnZmlsZSBbRklMRV0nLA0KICAgICAgICAgICAgYXJndW1lbnRzOiB7DQogICAgICAgICAgICAgIEZJTEU6IHsNCiAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5GSUxFLA0KICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJ2RhdGFVUkxcbiovKlxuJywNCiAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgfSwNCiAgICAgICAgICB7DQogICAgICAgICAgICBoaWRlRnJvbVBhbGV0dGU6ICFET09NY2hlY2ssDQogICAgICAgICAgICBvcGNvZGU6ICdET09NJywNCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwNCiAgICAgICAgICAgIHRleHQ6ICdET09NIFtfYV0nLA0KICAgICAgICAgICAgYXJndW1lbnRzOiB7DQogICAgICAgICAgICAgIF9hOiB7DQogICAgICAgICAgICAgICAgdHlwZTogJ0lubGluZURvb20nLA0KICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogJycsDQogICAgICAgICAgICAgIH0sDQogICAgICAgICAgICB9LA0KICAgICAgICAgIH0sDQogICAgICAgIF0sDQogICAgICAgIGN1c3RvbUZpZWxkVHlwZXMsDQogICAgICB9KTsNCiAgICAgIHJldHVybiBnZXRJbmZvOw0KICAgIH0NCiAgICBtdWx0aWZpZWxkVGVzdCgpIHt9DQogICAgdGV4dGFyZWEoYXJncykgew0KICAgICAgcmV0dXJuIGFyZ3MuVEVYVDsNCiAgICB9DQogICAgdGV4dGFyZWFJbmxpbmUoYXJncykgew0KICAgICAgcmV0dXJuIGFyZ3MuVEVYVDsNCiAgICB9DQogICAgc25hcEJvb2woYXJncykgew0KICAgICAgcmV0dXJuIFNjcmF0Y2guQ2FzdC50b0Jvb2xlYW4oYXJncy5CT09MKTsNCiAgICB9DQogICAgc2xpZGVySW5saW5lKGFyZ3MpIHsNCiAgICAgIHJldHVybiBTY3JhdGNoLkNhc3QudG9OdW1iZXIoYXJncy5OVU0uc3BsaXQoJywnKVswXSk7DQogICAgfQ0KICAgIGhpZGRlblN0cmluZyhhcmdzKSB7DQogICAgICByZXR1cm4gYXJncy5URVhUOw0KICAgIH0NCiAgICBkYXRlKGFyZ3MpIHsNCiAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoYXJncy5EQVRFLnJlcGxhY2VBbGwoJy0nLCAnLycpKTsNCiAgICAgIHJldHVybiAoZGF0ZS5nZXRUaW1lKCkpOw0KICAgIH0NCiAgICBmaWxlKGFyZ3MpIHsNCiAgICAgIGNvbnN0IGNyMSA9IGFyZ3MuRklMRS5pbmRleE9mKCdcbicpOw0KICAgICAgY29uc3QgY3IyID0gYXJncy5GSUxFLmluZGV4T2YoJ1xuJywgY3IxICsgMSk7DQogICAgICByZXR1cm4gYXJncy5GSUxFLnN1YnN0cihjcjIgKyAxKTsNCiAgICB9DQogICAgRE9PTShhcmdzKSB7DQogICAgICByZXR1cm4gJyc7DQogICAgfQ0KICB9DQogIFNjcmF0Y2guZXh0ZW5zaW9ucy5yZWdpc3RlcihuZXcgZXh0ZW5zaW9uKCkpOw0KfSkoU2NyYXRjaCk7DQo=","lmscomments":"https://extensions.turbowarp.org/Lily/CommentBlocks.js"},"meta":{"semver":"3.0.0","vm":"0.2.0","agent":"","platform":{"name":"TurboWarp","url":"https://turbowarp.org/"}}}